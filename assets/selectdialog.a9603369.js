import{R as c,P as u,C as o,M as d,K as l}from"./terminal.bd39b93c.js";class w{constructor(t,e,s){this.dialog=t,this.rect=e,this.contentsOffset=s,this.open=!1,this.count=0}}class x{getState(t,e){const s=e.contentsRect.width+4,i=e.contentsRect.height+4,n=(t.width-s)/2|0,h=(t.height-i)/2|0;return new w(e,new c(n,h,s,i),new u(n+2,h+2))}draw(t,e){const s=e.dialog,{x:i,y:n,width:h,height:r}=e.rect;t.fillRect(i,n,h,r,0,o.WHITE,o.BLACK),t.drawSingleBox(i,n,h,r),t.drawCenteredString(i+h/2|0,n," "+s.title+" "),s.drawContents(t,e.contentsOffset)}}class p{constructor(t,e){this.terminal=t,this.renderer=e||new x,this.dialogs=[]}add(t){this.dialogs.push(this.renderer.getState(this.terminal,t))}handleInput(){if(this.dialogs.length===0)return!1;const t=this.dialogs.length-1,e=this.dialogs[this.dialogs.length-1];return e.dialog.handleInput(this.terminal,e.contentsOffset)&&this.dialogs.splice(t,1),!0}draw(){for(let t=0;t<this.dialogs.length;t++)this.renderer.draw(this.terminal,this.dialogs[t])}}class g{constructor(t,e){this.contentsRect=t,this.title=e}}class C extends g{constructor(t,e){let s;e instanceof d?s=new c(0,0,e.getWidth(),e.getHeight()):s=new c(0,0,e.length,1),console.log("message rect",s),super(s,t),this.message=e}drawContents(t,e){this.message instanceof d?t.drawMessage(e.x,e.y,this.message):t.drawString(e.x,e.y,this.message)}handleInput(t){return t.isKeyPressed(l.VK_ESCAPE)}}class I extends g{constructor(t,e,s){let i=t.length;for(let r=0;r<e.length;r++)i=Math.max(i,e[r].length+4);const n=e.length,h=new c(0,0,i,n);super(h,t),this.options=e,this.callback=s,this.hoverIndex=-1}drawContents(t,e){for(let s=0;s<this.options.length;s++){const i=String.fromCharCode(65+s)+" - "+this.options[s];s===this.hoverIndex?t.drawString(e.x,e.y+s,i,o.BLACK,o.WHITE):t.drawString(e.x,e.y+s,i,o.WHITE,o.BLACK)}}handleInput(t,e){if(this.hoverIndex=-1,t.mouse.x>=e.x&&t.mouse.x<e.x+this.contentsRect.width&&t.mouse.y>=e.y&&t.mouse.y<e.y+this.contentsRect.height&&(this.hoverIndex=t.mouse.y-e.y,t.mouse.buttons[0].upCount===1))return this.callback(this.hoverIndex),!0;for(let s=0;s<this.options.length;s++)if(t.isKeyPressed(l.VK_A+s))return this.callback(s),!0;return t.isKeyPressed(l.VK_ESCAPE)}isMouseOverOption(t,e,s){return t.mouse.x>=e.x&&t.mouse.x<e.x+this.contentsRect.width&&t.mouse.y===e.y+s}}export{w as D,p as G,C as M,I as S,g as a};
