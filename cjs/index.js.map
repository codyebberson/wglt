{"version":3,"file":"index.js","sources":["../../../../src/blendmode.ts","../../../../src/boxutils.ts","../../node_modules/tslib/tslib.es6.js","../../../../src/color.ts","../../../../src/palettes/colors.ts","../../../../src/serialize.ts","../../../../src/cell.ts","../../../../src/chars.ts","../../../../src/utils.ts","../../../../src/console.ts","../../../../src/font.ts","../../../../src/fov.ts","../../../../src/point.ts","../../../../src/rect.ts","../../../../src/gui/dialogstate.ts","../../../../src/gui/defaultdialogrenderer.ts","../../../../src/gui.ts","../../../../src/gui/dialog.ts","../../../../src/gui/message.ts","../../../../src/input.ts","../../../../src/keys.ts","../../../../src/gui/messagedialog.ts","../../../../src/gui/scrollablemessagedialog.ts","../../../../src/gui/selectdialog.ts","../../../../src/image.ts","../../../../src/mouse.ts","../../../../src/palettes/c64.ts","../../../../src/palettes/colodore.ts","../../../../src/palettes/pico8.ts","../../../../src/path.ts","../../../../src/rng.ts","../../../../src/shaders.ts","../../../../src/terminal.ts"],"sourcesContent":["/**\n * The BlendMode enum defines how translucent cells are rendered.\n */\nexport enum BlendMode {\n  /**\n   * No blending.  Alpha is ignored.\n   */\n  None = 0,\n\n  /**\n   * Alpha blending.\n   *\n   * dstRGB = (srcRGB * srcA) + (dstRGB * (1-srcA))\n   *\n   * dstA = srcA + (dstA * (1-srcA))\n   */\n  Blend = 1,\n\n  /**\n   * Additive blending.\n   *\n   * dstRGB = (srcRGB * srcA) + dstRGB\n   *\n   * dstA = dstA\n   */\n  Add = 2,\n}\n","import { Console } from './console';\n\n/**\n * Details about box characters.\n * The first element is the array of details for the first box char (0xB3).\n * Each sub array is the count of stems for top, right, bottom, and left.\n */\nconst BOX_CHAR_DETAILS = [\n  [1, 0, 1, 0], // 0xB3\n  [1, 0, 1, 1], // 0xB4\n  [1, 0, 1, 2], // 0xB5\n  [2, 0, 2, 1], // 0xB6\n  [0, 0, 2, 1], // 0xB7\n  [0, 0, 1, 2], // 0xB8\n  [2, 0, 2, 2], // 0xB9\n  [2, 0, 2, 0], // 0xBA\n  [0, 0, 2, 2], // 0xBB\n  [2, 0, 0, 2], // 0xBC\n  [2, 0, 0, 1], // 0xBD\n  [1, 0, 0, 2], // 0xBE\n  [0, 0, 1, 1], // 0xBF\n  [1, 1, 0, 0], // 0xC0\n  [1, 1, 0, 1], // 0xC1\n  [0, 1, 1, 1], // 0xC2\n  [1, 1, 1, 0], // 0xC3\n  [0, 1, 0, 1], // 0xC4\n  [1, 1, 1, 1], // 0xC5\n  [1, 2, 1, 0], // 0xC6\n  [2, 1, 2, 0], // 0xC7\n  [2, 2, 0, 0], // 0xC8\n  [0, 2, 2, 0], // 0xC9\n  [2, 2, 0, 2], // 0xCA\n  [0, 2, 2, 2], // 0xCB\n  [2, 2, 2, 0], // 0xCC\n  [0, 2, 0, 2], // 0xCD\n  [2, 2, 2, 2], // 0xCE\n  [1, 2, 0, 2], // 0xCF\n  [2, 1, 0, 1], // 0xD0\n  [0, 2, 1, 2], // 0xD1\n  [0, 1, 2, 1], // 0xD2\n  [2, 1, 0, 0], // 0xD3\n  [1, 2, 0, 0], // 0xD4\n  [0, 2, 1, 0], // 0xD5\n  [0, 1, 2, 0], // 0xD6\n  [2, 1, 2, 1], // 0xD7\n  [1, 2, 1, 2], // 0xD8\n  [1, 0, 0, 1], // 0xD9\n  [0, 1, 1, 0], // 0xDA\n];\n\nfunction isBoxCell(con: Console, x: number, y: number): boolean {\n  const charCode = con.getCharCode(x, y);\n  return charCode !== undefined && charCode >= 0xb3 && charCode <= 0xda;\n}\n\nfunction getBoxCount(con: Console, x: number, y: number, index: number): number {\n  if (x < 0 || y < 0 || x >= con.width || y >= con.height) {\n    return 0;\n  }\n  const charCode = con.getCharCode(x, y);\n  if (charCode === undefined || charCode < 0xb3 || charCode > 0xda) {\n    return 0;\n  }\n  return BOX_CHAR_DETAILS[charCode - 0xb3][index];\n}\n\nfunction getBoxCell(up: number, right: number, down: number, left: number): number {\n  for (let i = 0; i < BOX_CHAR_DETAILS.length; i++) {\n    const row = BOX_CHAR_DETAILS[i];\n    if (row[0] === up && row[1] === right && row[2] === down && row[3] === left) {\n      return 0xb3 + i;\n    }\n  }\n  return 0;\n}\n\nexport function fixBoxCells(con: Console): void {\n  for (let y = 0; y < con.height; y++) {\n    for (let x = 0; x < con.width; x++) {\n      if (isBoxCell(con, x, y)) {\n        let up = getBoxCount(con, x, y - 1, 2);\n        let right = getBoxCount(con, x + 1, y, 3);\n        let down = getBoxCount(con, x, y + 1, 0);\n        let left = getBoxCount(con, x - 1, y, 1);\n\n        // There are no single-direction stubs.\n        // If we need one, then we create a full vertical or horizontal pipe.\n        if (up > 0 && right === 0 && down === 0 && left === 0) {\n          down = up;\n        } else if (up === 0 && right > 0 && down === 0 && left === 0) {\n          left = right;\n        } else if (up === 0 && right === 0 && down > 0 && left === 0) {\n          up = down;\n        } else if (up === 0 && right === 0 && down === 0 && left > 0) {\n          right = left;\n        }\n\n        // Vertical and horizontal axis must have same width.\n        if (left > 0 && right > 0) {\n          left = right = Math.max(left, right);\n        }\n        if (up > 0 && down > 0) {\n          up = down = Math.max(up, down);\n        }\n\n        const charCode = getBoxCell(up, right, down, left);\n\n        if ((up || right || down || left) && !(charCode >= 0xb3 && charCode <= 0xda)) {\n          throw new Error(\n            'invalid char code! (up=' + up + ', right=' + right + ', down=' + down + ', left=' + left + ')'\n          );\n        }\n\n        con.drawChar(x, y, charCode);\n      }\n    }\n  }\n}\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","export type Color = number;\n\n/**\n * Creates a big-endian 32-bit RGBA color from red, green, and blue components.\n * @param r Red (0-255).\n * @param g Green (0-255).\n * @param b Blue (0-255).\n * @param a Optional alpha (0-255).\n * @return A 32-bit unsigned integer color.\n */\nexport function fromRgb(r: number, g: number, b: number, a?: number): Color {\n  if (a === undefined) {\n    a = 255;\n  }\n  return (r << 24) + (g << 16) + (b << 8) + a;\n}\n\n/**\n * Converts a color from HSV format to RGBA format.\n *\n * Based on: https://stackoverflow.com/a/17243070/2051724\n *\n * @param h Hue (0.0 - 1.0).\n * @param s Saturation (0.0 - 1.0).\n * @param v Value (0.0 - 1.0).\n * @param a Optional alpha (0.0 - 1.0).\n * @return A 32-bit unsigned integer color.\n */\nexport function fromHsv(h: number, s: number, v: number, a?: number): Color {\n  const i = (h * 6) | 0;\n  const f = h * 6 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n  let r, g, b;\n  switch (i % 6) {\n    case 0:\n      (r = v), (g = t), (b = p);\n      break;\n    case 1:\n      (r = q), (g = v), (b = p);\n      break;\n    case 2:\n      (r = p), (g = v), (b = t);\n      break;\n    case 3:\n      (r = p), (g = q), (b = v);\n      break;\n    case 4:\n      (r = t), (g = p), (b = v);\n      break;\n    case 5:\n      (r = v), (g = p), (b = q);\n      break;\n    default:\n      r = 0;\n      g = 0;\n      b = 0;\n  }\n  if (a === undefined) {\n    a = 1.0;\n  }\n  return fromRgb((r * 255) | 0, (g * 255) | 0, (b * 255) | 0, (a * 255) | 0);\n}\n","import { fromRgb } from '../color';\n\n/**\n * Orignal CGA palette.\n * See: https://en.wikipedia.org/wiki/Color_Graphics_Adapter\n * See: https://lospec.com/palette-list/color-graphics-adapter\n */\nexport const Colors = {\n  BLACK: fromRgb(0, 0, 0),\n  WHITE: fromRgb(0xff, 0xff, 0xff),\n  LIGHT_GRAY: fromRgb(0xaa, 0xaa, 0xaa),\n  DARK_GRAY: fromRgb(0x55, 0x55, 0x55),\n  YELLOW: fromRgb(0xff, 0xff, 0x55),\n  BROWN: fromRgb(0xaa, 0x55, 0x00),\n  LIGHT_RED: fromRgb(0xff, 0x55, 0x55),\n  DARK_RED: fromRgb(0xaa, 0x00, 0x00),\n  LIGHT_GREEN: fromRgb(0x55, 0xff, 0x55),\n  DARK_GREEN: fromRgb(0x00, 0xaa, 0x00),\n  LIGHT_CYAN: fromRgb(0x55, 0xff, 0xff),\n  DARK_CYAN: fromRgb(0x00, 0xaa, 0xaa),\n  LIGHT_BLUE: fromRgb(0x55, 0x55, 0xff),\n  DARK_BLUE: fromRgb(0x00, 0x00, 0xaa),\n  LIGHT_MAGENTA: fromRgb(0xff, 0x55, 0xff),\n  DARK_MAGENTA: fromRgb(0xaa, 0x00, 0xaa),\n  ORANGE: fromRgb(0xff, 0x88, 0x00),\n};\n","interface SerializationBundle {\n  instances: InstancePlaceholder[];\n  root: unknown;\n}\n\ninterface InstancePlaceholder {\n  $type?: string;\n}\n\ninterface ReferencePlaceholder {\n  $ref: number;\n}\n\nconst classDefinitions = new Map<string, ObjectConstructor>();\n\n/**\n * Decorates a class to make serializable.\n * Any class with the @serializable decorator will be serialized and deserialized.\n * @param value The TypeScript class to mark as serializable.\n */\nexport function serializable(value: { name: string }): void {\n  classDefinitions.set(value.name, value as ObjectConstructor);\n}\n\n/**\n * Serializes a value to JSON.\n * Handles circular references and class instances.\n * @param obj The root object to serialize.\n * @returns A string representation of the object graph.\n */\nexport function serialize(obj: unknown): string {\n  const instances: InstancePlaceholder[] = [];\n  const instancesMap = new WeakMap<object, number>();\n  const root = replace(obj);\n  return JSON.stringify({ instances, root });\n\n  function replace(input: unknown): unknown {\n    if (Array.isArray(input)) {\n      return replaceArray(input);\n    } else if (input && typeof input === 'object') {\n      return replaceObject(input as Record<string, unknown>);\n    } else {\n      return input;\n    }\n  }\n\n  function replaceArray(input: unknown[]): unknown[] {\n    const result = [];\n    for (let i = 0; i < input.length; i++) {\n      result[i] = replace(input[i]);\n    }\n    return result;\n  }\n\n  function replaceObject(input: Record<string, unknown>): Record<string, unknown> {\n    if (input && input.constructor.name && input.constructor.name !== 'Object') {\n      if (!classDefinitions.has(input.constructor.name)) {\n        throw new Error(`Class ${input.constructor.name} is not serializable.`);\n      }\n      if (instancesMap.has(input)) {\n        return { $ref: instancesMap.get(input) };\n      }\n      const $ref = instances.length;\n      instances.push({ $type: input.constructor.name });\n      instancesMap.set(input, $ref);\n      instances[$ref] = { ...replaceObjectProperties(input), $type: input.constructor.name };\n      return { $ref };\n    }\n    return replaceObjectProperties(input);\n  }\n\n  function replaceObjectProperties(input: Record<string, unknown>): Record<string, unknown> {\n    const result: Record<string, unknown> = {};\n    for (const key of Object.keys(input)) {\n      result[key] = replace(input[key]);\n    }\n    return result;\n  }\n}\n\n/**\n * Deserializes a JSON string to an object graph.\n * Handles circular references and class instances.\n * @param str The JSON string to deserialize.\n * @returns The deserialized object graph.\n */\nexport function deserialize(str: string): unknown {\n  const input = JSON.parse(str) as SerializationBundle;\n  const instances = input.instances;\n\n  // First, replace all objects with class instances\n  for (let i = 0; i < instances.length; i++) {\n    const instance = instances[i];\n    const classDefinition = classDefinitions.get(instance.$type as string) as ObjectConstructor;\n    delete instance.$type;\n    instances[i] = Object.create(classDefinition.prototype, Object.getOwnPropertyDescriptors(instance));\n  }\n\n  // Second, replace all references in the list of class instances\n  for (let i = 0; i < instances.length; i++) {\n    replaceObjectProperties(instances[i] as unknown as Record<string, unknown>);\n  }\n\n  // Finally, replace all references in the root object graph\n  return replace(input.root);\n\n  function replace(input: unknown): unknown {\n    if (Array.isArray(input)) {\n      return replaceArray(input);\n    } else if (input && typeof input === 'object') {\n      return replaceObject(input as Record<string, unknown>);\n    } else {\n      return input;\n    }\n  }\n\n  function replaceArray(input: unknown[]): unknown[] {\n    for (let i = 0; i < input.length; i++) {\n      input[i] = replace(input[i]);\n    }\n    return input;\n  }\n\n  function replaceObject(input: Record<string, unknown>): InstancePlaceholder | Record<string, unknown> {\n    if (isRef(input)) {\n      return instances[input.$ref];\n    }\n    replaceObjectProperties(input);\n    return input;\n  }\n\n  function replaceObjectProperties(input: Record<string, unknown>): void {\n    for (const [key, value] of Object.entries(input)) {\n      input[key] = replace(value);\n    }\n  }\n}\n\nfunction isRef(value: unknown): value is ReferencePlaceholder {\n  return !!(value && typeof value === 'object' && '$ref' in value);\n}\n","import { BlendMode } from './blendmode';\nimport { Color, fromRgb } from './color';\nimport { Colors } from './palettes/colors';\nimport { serializable } from './serialize';\n\nfunction convertCharCode(charCode: string | number): number {\n  if (typeof charCode === 'string' && charCode.length > 0) {\n    return charCode.charCodeAt(0);\n  } else {\n    return charCode as number;\n  }\n}\n\n@serializable\nexport class Cell {\n  readonly x: number;\n  readonly y: number;\n  charCode: number;\n  fg: Color;\n  bg: Color;\n  dirty: boolean;\n  blocked: boolean;\n  blockedSight: boolean;\n  explored: boolean;\n  visible: boolean;\n  pathId: number;\n  g: number;\n  h: number;\n  prev: Cell | null;\n\n  constructor(x: number, y: number, charCode?: string | number, fg?: Color, bg?: Color) {\n    this.x = x;\n    this.y = y;\n\n    if (charCode !== undefined) {\n      this.charCode = convertCharCode(charCode);\n    } else {\n      this.charCode = ' '.charCodeAt(0);\n    }\n\n    if (fg !== undefined) {\n      this.fg = fg;\n    } else {\n      this.fg = Colors.WHITE;\n    }\n\n    if (bg !== undefined) {\n      this.bg = bg;\n    } else {\n      this.bg = Colors.BLACK;\n    }\n\n    this.dirty = true;\n    this.blocked = false;\n    this.blockedSight = false;\n    this.explored = false;\n    this.visible = false;\n    this.pathId = -1;\n    this.g = 0;\n    this.h = 0;\n    this.prev = null;\n  }\n\n  setCharCode(charCode: number): void {\n    if (this.charCode !== charCode) {\n      this.charCode = charCode;\n      this.dirty = true;\n    }\n  }\n\n  setForeground(fg: Color): void {\n    if (fg !== undefined && fg !== null && fg !== this.fg) {\n      this.fg = fg;\n      this.dirty = true;\n    }\n  }\n\n  setBackground(bg: Color): void {\n    if (bg !== undefined && bg !== null && bg !== this.bg) {\n      this.bg = bg;\n      this.dirty = true;\n    }\n  }\n\n  setValue(charCode: string | number, fg?: Color, bg?: Color): boolean {\n    if (typeof charCode === 'string') {\n      charCode = charCode.charCodeAt(0);\n    }\n    if (typeof charCode === 'number') {\n      this.setCharCode(charCode);\n\n      if (fg !== undefined) {\n        this.setForeground(fg);\n      }\n      if (bg !== undefined) {\n        this.setBackground(bg);\n      }\n    } else {\n      this.drawCell(charCode, BlendMode.None);\n    }\n    return this.dirty;\n  }\n\n  drawCell(otherCell: Cell, blendMode?: BlendMode): void {\n    const alpha = otherCell.bg & 0xff;\n\n    if (blendMode === BlendMode.None || otherCell.charCode > 0) {\n      this.setCharCode(otherCell.charCode);\n      this.setForeground(otherCell.fg);\n    } else if (alpha > 0 && alpha < 255) {\n      this.setForeground(this.blendColors(this.fg, otherCell.bg, blendMode));\n    }\n\n    if (blendMode === BlendMode.None || alpha === 255) {\n      this.setBackground(otherCell.bg);\n    } else if (alpha > 0) {\n      this.setBackground(this.blendColors(this.bg, otherCell.bg, blendMode));\n    }\n  }\n\n  private blendColors(c1: Color, c2: Color, blendMode?: BlendMode): Color {\n    const alpha = c2 & 0xff;\n    const w1 = (255 - alpha) / 255.0;\n    const w2 = 1.0 - w1;\n    const r1 = (c1 >> 24) & 0xff;\n    const g1 = (c1 >> 16) & 0xff;\n    const b1 = (c1 >> 8) & 0xff;\n    const r2 = (c2 >> 24) & 0xff;\n    const g2 = (c2 >> 16) & 0xff;\n    const b2 = (c2 >> 8) & 0xff;\n\n    switch (blendMode) {\n      case BlendMode.Blend:\n        return fromRgb((w1 * r1 + w2 * r2) | 0, (w1 * g1 + w2 * g2) | 0, (w1 * b1 + w2 * b2) | 0);\n\n      case BlendMode.Add:\n        return fromRgb(this.clamp((r1 + w2 * r2) | 0), this.clamp((g1 + w2 * g2) | 0), this.clamp((b1 + w2 * b2) | 0));\n\n      default:\n        return c2;\n    }\n  }\n\n  private clamp(x: number): number {\n    return Math.min(255, x);\n  }\n}\n","// https://en.wikipedia.org/wiki/Code_page_437\n// https://en.wikipedia.org/wiki/Block_Elements\n// https://en.wikipedia.org/wiki/Box-drawing_character\n\nexport enum Chars {\n  SMILEY = 1,\n  INVERSE_SMILEY = 2,\n  HEART = 3,\n  DIAMOND = 4,\n  CLUB = 5,\n  SPADE = 6,\n  BULLET = 7,\n  INVERSE_BULLET = 8,\n\n  LIGHT_SHADE = 176,\n  MEDIUM_SHADE = 177,\n  DARK_SHADE = 178,\n\n  BOX_SINGLE_VERTICAL = 179,\n  BOX_SINGLE_VERTICAL_AND_SINGLE_LEFT = 180,\n  BOX_DOUBLE_VERTICAL_AND_DOUBLE_LEFT = 185,\n  BOX_DOUBLE_VERTICAL = 186,\n  BOX_DOUBLE_DOWN_AND_DOUBLE_LEFT = 187,\n  BOX_DOUBLE_UP_AND_DOUBLE_LEFT = 188,\n  BOX_SINGLE_DOWN_AND_SINGLE_LEFT = 191,\n  BOX_SINGLE_UP_AND_SINGLE_RIGHT = 192,\n  BOX_SINGLE_HORIZONTAL_AND_SINGLE_UP = 193,\n  BOX_SINGLE_HORIZONTAL_AND_SINGLE_DOWN = 194,\n  BOX_SINGLE_VERTICAL_AND_SINGLE_RIGHT = 195,\n  BOX_SINGLE_HORIZONTAL = 196,\n  BOX_SINGLE_VERTICAL_AND_SINGLE_HORIZONTAL = 197,\n  BOX_DOUBLE_UP_AND_DOUBLE_RIGHT = 200,\n  BOX_DOUBLE_DOWN_AND_DOUBLE_RIGHT = 201,\n  BOX_DOUBLE_HORIZONTAL_AND_DOUBLE_UP = 202,\n  BOX_DOUBLE_HORIZONTAL_AND_DOUBLE_DOWN = 203,\n  BOX_DOUBLE_VERTICAL_AND_DOUBLE_RIGHT = 204,\n  BOX_DOUBLE_HORIZONTAL = 205,\n  BOX_DOUBLE_VERTICAL_AND_DOUBLE_HORIZONTAL = 206,\n  BOX_SINGLE_UP_AND_SINGLE_LEFT = 13 * 16 + 9,\n  BOX_SINGLE_DOWN_AND_SINGLE_RIGHT = 13 * 16 + 10,\n\n  BLOCK_FULL = 219,\n  BLOCK_BOTTOM_HALF = 13 * 16 + 12,\n  BLOCK_LEFT_HALF = 13 * 16 + 13,\n  BLOCK_RIGHT_HALF = 13 * 16 + 14,\n  BLOCK_TOP_HALF = 13 * 16 + 15,\n}\n","/**\n * Returns the input string wrapped to the maximum line length.\n * @param str The original input string.\n * @param maxLength The maximum length of a single line.\n * @returns Array of word wrapped lines.\n */\nexport function wordWrap(str: string, maxLength: number): string[] {\n  const regex = new RegExp('(\\\\S(.{0,' + maxLength + '}\\\\S)?)\\\\s+', 'g');\n  return (str + ' ')\n    .replace(regex, '$1\\n')\n    .trim()\n    .split('\\n')\n    .map((line) => line.trim());\n}\n\n/**\n * Capitalizes the first letter of the input string.\n * @param str The original input string.\n * @returns The capitalized string.\n */\nexport function capitalize(str: string): string {\n  if (!str) {\n    return str;\n  }\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n","import { BlendMode } from './blendmode';\nimport { Cell } from './cell';\nimport { Chars } from './chars';\nimport { Color } from './color';\nimport { Message } from './gui/message';\nimport { Rect } from './rect';\nimport { serializable } from './serialize';\nimport { wordWrap } from './utils';\n\n@serializable\nexport class Console {\n  readonly width: number;\n  readonly height: number;\n  readonly grid: Cell[][];\n  originX: number;\n  originY: number;\n  minX: number;\n  maxX: number;\n  minY: number;\n  maxY: number;\n  radius: number;\n  clip?: Rect;\n\n  constructor(width: number, height: number, blockedFunc?: (x: number, y: number) => boolean) {\n    this.width = width;\n    this.height = height;\n    this.grid = [];\n    this.originX = 0;\n    this.originY = 0;\n    this.minX = 0;\n    this.maxX = 0;\n    this.minY = 0;\n    this.maxY = 0;\n    this.radius = 0;\n\n    for (let y = 0; y < height; y++) {\n      const row = [];\n      for (let x = 0; x < width; x++) {\n        row.push(new Cell(x, y));\n      }\n      this.grid.push(row);\n    }\n\n    this.clear();\n\n    if (blockedFunc) {\n      for (let y = 0; y < height; y++) {\n        for (let x = 0; x < width; x++) {\n          this.grid[y][x].blocked = this.grid[y][x].blockedSight = blockedFunc(x, y);\n        }\n      }\n    }\n  }\n\n  clear(): void {\n    for (let y = 0; y < this.height; y++) {\n      for (let x = 0; x < this.width; x++) {\n        this.drawChar(x, y, 0);\n      }\n    }\n  }\n\n  getCell(x: number, y: number): Cell | undefined {\n    if (x < 0 || y < 0 || x >= this.width || y >= this.height) {\n      return undefined;\n    }\n    return this.grid[y][x];\n  }\n\n  getCharCode(x: number, y: number): number | undefined {\n    if (x < 0 || y < 0 || x >= this.width || y >= this.height) {\n      return undefined;\n    }\n    return this.grid[y][x].charCode;\n  }\n\n  drawChar(x: number, y: number, c: string | number, fg?: Color, bg?: Color): void {\n    if (this.clip && !this.clip.contains({ x, y })) {\n      return;\n    }\n    if (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      this.grid[y | 0][x | 0].setValue(c, fg, bg);\n    }\n  }\n\n  drawString(x: number, y: number, str: string, fg?: Color, bg?: Color): void {\n    const lines = str.split('\\n');\n    for (let i = 0; i < lines.length; i++) {\n      this.drawStringLine(x, y + i, lines[i], fg, bg);\n    }\n  }\n\n  drawStringLine(x: number, y: number, line: string, fg?: Color, bg?: Color): void {\n    for (let j = 0; j < line.length; j++) {\n      this.drawChar(x + j, y, line.charCodeAt(j), fg, bg);\n    }\n  }\n\n  drawCenteredString(x: number, y: number, str: string, fg?: Color, bg?: Color): void {\n    this.drawString(x - Math.floor(str.length / 2), y, str, fg, bg);\n  }\n\n  drawMessage(x: number, y: number, message: Message, maxWidth?: number): number {\n    if (message.text) {\n      const lines = wordWrap(message.text, maxWidth || this.width - x);\n      for (const line of lines) {\n        this.drawStringLine(x, y, line, message.fg, message.bg);\n        y++;\n      }\n    }\n    if (message.children) {\n      for (const child of message.children) {\n        y = this.drawMessage(x, y, child, maxWidth);\n      }\n    }\n    return y;\n  }\n\n  drawHLine(x: number, y: number, width: number, c: string | number, fg?: Color, bg?: Color): void {\n    for (let xi = x; xi < x + width; xi++) {\n      this.drawChar(xi, y, c, fg, bg);\n    }\n  }\n\n  drawVLine(x: number, y: number, height: number, c: string | number, fg?: Color, bg?: Color): void {\n    for (let yi = y; yi < y + height; yi++) {\n      this.drawChar(x, yi, c, fg, bg);\n    }\n  }\n\n  drawRect(x: number, y: number, width: number, height: number, c: string | number, fg?: Color, bg?: Color): void {\n    this.drawHLine(x, y, width, c, fg, bg);\n    this.drawHLine(x, y + height - 1, width, c, fg, bg);\n    this.drawVLine(x, y, height, c, fg, bg);\n    this.drawVLine(x + width - 1, y, height, c, fg, bg);\n  }\n\n  drawBox(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    topChar: number,\n    rightChar: number,\n    bottomChar: number,\n    leftChar: number,\n    topLeftChar: number,\n    topRightChar: number,\n    bottomRightChar: number,\n    bottomLeftChar: number,\n    fg?: Color,\n    bg?: Color\n  ): void {\n    this.drawHLine(x, y, width, topChar, fg, bg);\n    this.drawHLine(x, y + height - 1, width, bottomChar, fg, bg);\n\n    this.drawVLine(x, y, height, leftChar, fg, bg);\n    this.drawVLine(x + width - 1, y, height, rightChar, fg, bg);\n\n    this.drawChar(x, y, topLeftChar, fg, bg);\n    this.drawChar(x + width - 1, y, topRightChar, fg, bg);\n    this.drawChar(x, y + height - 1, bottomLeftChar, fg, bg);\n    this.drawChar(x + width - 1, y + height - 1, bottomRightChar, fg, bg);\n  }\n\n  drawSingleBox(x: number, y: number, width: number, height: number, fg?: Color, bg?: Color): void {\n    this.drawBox(\n      x,\n      y,\n      width,\n      height,\n      Chars.BOX_SINGLE_HORIZONTAL,\n      Chars.BOX_SINGLE_VERTICAL,\n      Chars.BOX_SINGLE_HORIZONTAL,\n      Chars.BOX_SINGLE_VERTICAL,\n      Chars.BOX_SINGLE_DOWN_AND_SINGLE_RIGHT,\n      Chars.BOX_SINGLE_DOWN_AND_SINGLE_LEFT,\n      Chars.BOX_SINGLE_UP_AND_SINGLE_LEFT,\n      Chars.BOX_SINGLE_UP_AND_SINGLE_RIGHT,\n      fg,\n      bg\n    );\n  }\n\n  drawDoubleBox(x: number, y: number, width: number, height: number, fg?: Color, bg?: Color): void {\n    this.drawBox(\n      x,\n      y,\n      width,\n      height,\n      Chars.BOX_DOUBLE_HORIZONTAL,\n      Chars.BOX_DOUBLE_VERTICAL,\n      Chars.BOX_DOUBLE_HORIZONTAL,\n      Chars.BOX_DOUBLE_VERTICAL,\n      Chars.BOX_DOUBLE_DOWN_AND_DOUBLE_RIGHT,\n      Chars.BOX_DOUBLE_DOWN_AND_DOUBLE_LEFT,\n      Chars.BOX_DOUBLE_UP_AND_DOUBLE_LEFT,\n      Chars.BOX_DOUBLE_UP_AND_DOUBLE_RIGHT,\n      fg,\n      bg\n    );\n  }\n\n  fillRect(x: number, y: number, width: number, height: number, c: string | number, fg?: Color, bg?: Color): void {\n    for (let yi = y; yi < y + height; yi++) {\n      this.drawHLine(x, yi, width, c, fg, bg);\n    }\n  }\n\n  drawConsole(\n    dstX: number,\n    dstY: number,\n    srcConsole: Console,\n    srcX: number,\n    srcY: number,\n    srcWidth: number,\n    srcHeight: number,\n    blendMode?: BlendMode\n  ): void {\n    blendMode = blendMode || BlendMode.None;\n\n    for (let y = 0; y < srcHeight; y++) {\n      for (let x = 0; x < srcWidth; x++) {\n        const cell = srcConsole.getCell(srcX + x, srcY + y);\n        if (cell) {\n          this.drawCell(dstX + x, dstY + y, cell, blendMode);\n        }\n      }\n    }\n  }\n\n  drawCell(x: number, y: number, cell: Cell, blendMode?: BlendMode): void {\n    if (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      this.grid[y][x].drawCell(cell, blendMode);\n    }\n  }\n\n  setBlocked(x: number, y: number, blocked: boolean): void {\n    if (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      this.grid[y][x].blocked = blocked;\n    }\n  }\n\n  setBlockedSight(x: number, y: number, blockedSight: boolean): void {\n    if (x >= 0 && x < this.width && y >= 0 && y < this.height) {\n      this.grid[y][x].blockedSight = blockedSight;\n    }\n  }\n\n  isVisible(x: number, y: number): boolean {\n    if (x < this.minX || x > this.maxX || y < this.minY || y > this.maxY) {\n      return false;\n    }\n    return this.grid[y][x].visible;\n  }\n\n  isBlocked(x: number, y: number): boolean {\n    if (x < 0 || x > this.width || y < 0 || y > this.height) {\n      return true;\n    }\n    return this.grid[y][x].blocked;\n  }\n\n  isBlockedSight(x: number, y: number): boolean {\n    if (x < 0 || x > this.width || y < 0 || y > this.height) {\n      return true;\n    }\n    return this.grid[y][x].blockedSight;\n  }\n\n  /**\n   * Compute the FOV in an octant adjacent to the Y axis\n   */\n  private computeOctantY(deltaX: number, deltaY: number): void {\n    const startSlopes: number[] = [];\n    const endSlopes: number[] = [];\n    let iteration = 1;\n    let totalObstacles = 0;\n    let obstaclesInLastLine = 0;\n    let minSlope = 0;\n    let x;\n    let y;\n    let halfSlope;\n    let processedCell;\n    let visible;\n    let extended;\n    let centreSlope;\n    let startSlope;\n    let endSlope;\n    let previousEndSlope;\n\n    for (\n      y = this.originY + deltaY;\n      y >= this.minY && y <= this.maxY;\n      y += deltaY, obstaclesInLastLine = totalObstacles, ++iteration\n    ) {\n      halfSlope = 0.5 / iteration;\n      previousEndSlope = -1;\n      for (\n        processedCell = Math.floor(minSlope * iteration + 0.5), x = this.originX + processedCell * deltaX;\n        processedCell <= iteration && x >= this.minX && x <= this.maxX;\n        x += deltaX, ++processedCell, previousEndSlope = endSlope\n      ) {\n        visible = true;\n        extended = false;\n        centreSlope = processedCell / iteration;\n        startSlope = previousEndSlope;\n        endSlope = centreSlope + halfSlope;\n\n        if (obstaclesInLastLine > 0) {\n          if (\n            !(this.grid[y - deltaY][x].visible && !this.grid[y - deltaY][x].blockedSight) &&\n            !(this.grid[y - deltaY][x - deltaX].visible && !this.grid[y - deltaY][x - deltaX].blockedSight)\n          ) {\n            visible = false;\n          } else {\n            for (let idx = 0; idx < obstaclesInLastLine && visible; ++idx) {\n              if (startSlope <= endSlopes[idx] && endSlope >= startSlopes[idx]) {\n                if (!this.grid[y][x].blockedSight) {\n                  if (centreSlope > startSlopes[idx] && centreSlope < endSlopes[idx]) {\n                    visible = false;\n                    break;\n                  }\n                } else {\n                  if (startSlope >= startSlopes[idx] && endSlope <= endSlopes[idx]) {\n                    visible = false;\n                    break;\n                  } else {\n                    startSlopes[idx] = Math.min(startSlopes[idx], startSlope);\n                    endSlopes[idx] = Math.max(endSlopes[idx], endSlope);\n                    extended = true;\n                  }\n                }\n              }\n            }\n          }\n        }\n        if (visible) {\n          this.grid[y][x].visible = true;\n          if (this.grid[y][x].blockedSight) {\n            if (minSlope >= startSlope) {\n              minSlope = endSlope;\n            } else if (!extended) {\n              startSlopes[totalObstacles] = startSlope;\n              endSlopes[totalObstacles++] = endSlope;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Compute the FOV in an octant adjacent to the X axis\n   */\n  private computeOctantX(deltaX: number, deltaY: number): void {\n    const startSlopes: number[] = [];\n    const endSlopes: number[] = [];\n    let iteration = 1;\n    let totalObstacles = 0;\n    let obstaclesInLastLine = 0;\n    let minSlope = 0;\n    let x;\n    let y;\n    let halfSlope;\n    let processedCell;\n    let visible;\n    let extended;\n    let centreSlope;\n    let startSlope;\n    let endSlope;\n    let previousEndSlope;\n\n    for (\n      x = this.originX + deltaX;\n      x >= this.minX && x <= this.maxX;\n      x += deltaX, obstaclesInLastLine = totalObstacles, ++iteration\n    ) {\n      halfSlope = 0.5 / iteration;\n      previousEndSlope = -1;\n      for (\n        processedCell = Math.floor(minSlope * iteration + 0.5), y = this.originY + processedCell * deltaY;\n        processedCell <= iteration && y >= this.minY && y <= this.maxY;\n        y += deltaY, ++processedCell, previousEndSlope = endSlope\n      ) {\n        visible = true;\n        extended = false;\n        centreSlope = processedCell / iteration;\n        startSlope = previousEndSlope;\n        endSlope = centreSlope + halfSlope;\n\n        if (obstaclesInLastLine > 0) {\n          if (\n            !(this.grid[y][x - deltaX].visible && !this.grid[y][x - deltaX].blockedSight) &&\n            !(this.grid[y - deltaY][x - deltaX].visible && !this.grid[y - deltaY][x - deltaX].blockedSight)\n          ) {\n            visible = false;\n          } else {\n            for (let idx = 0; idx < obstaclesInLastLine && visible; ++idx) {\n              if (startSlope <= endSlopes[idx] && endSlope >= startSlopes[idx]) {\n                if (!this.grid[y][x].blockedSight) {\n                  if (centreSlope > startSlopes[idx] && centreSlope < endSlopes[idx]) {\n                    visible = false;\n                    break;\n                  }\n                } else {\n                  if (startSlope >= startSlopes[idx] && endSlope <= endSlopes[idx]) {\n                    visible = false;\n                    break;\n                  } else {\n                    startSlopes[idx] = Math.min(startSlopes[idx], startSlope);\n                    endSlopes[idx] = Math.max(endSlopes[idx], endSlope);\n                    extended = true;\n                  }\n                }\n              }\n            }\n          }\n        }\n        if (visible) {\n          this.grid[y][x].visible = true;\n          if (this.grid[y][x].blockedSight) {\n            if (minSlope >= startSlope) {\n              minSlope = endSlope;\n            } else if (!extended) {\n              startSlopes[totalObstacles] = startSlope;\n              endSlopes[totalObstacles++] = endSlope;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  computeFov(originX: number, originY: number, radius: number, opt_noClear?: boolean, opt_octants?: number): void {\n    this.originX = originX;\n    this.originY = originY;\n    this.radius = radius;\n\n    if (opt_noClear) {\n      this.minX = Math.min(this.minX, Math.max(0, originX - radius));\n      this.minY = Math.min(this.minY, Math.max(0, originY - radius));\n      this.maxX = Math.max(this.maxX, Math.min(this.width - 1, originX + radius));\n      this.maxY = Math.max(this.maxY, Math.min(this.height - 1, originY + radius));\n    } else {\n      this.minX = Math.max(0, originX - radius);\n      this.minY = Math.max(0, originY - radius);\n      this.maxX = Math.min(this.width - 1, originX + radius);\n      this.maxY = Math.min(this.height - 1, originY + radius);\n\n      for (let y = this.minY; y <= this.maxY; y++) {\n        for (let x = this.minX; x <= this.maxX; x++) {\n          this.grid[y][x].visible = false;\n        }\n      }\n    }\n\n    this.grid[originY][originX].visible = true;\n\n    if (opt_octants === undefined) {\n      this.computeOctantY(1, 1);\n      this.computeOctantX(1, 1);\n      this.computeOctantX(1, -1);\n      this.computeOctantY(1, -1);\n      this.computeOctantY(-1, -1);\n      this.computeOctantX(-1, -1);\n      this.computeOctantX(-1, 1);\n      this.computeOctantY(-1, 1);\n    } else {\n      //   \\ 4 | 3 /\n      //    \\  |  /\n      //  5  \\ | /  2\n      //      \\|/\n      // ------+-------\n      //      /|\\\n      //  6  / | \\  1\n      //    /  |  \\\n      //   / 7 | 0 \\\n      if (opt_octants & 0x001) {\n        this.computeOctantY(1, 1);\n      }\n\n      if (opt_octants & 0x002) {\n        this.computeOctantX(1, 1);\n      }\n\n      if (opt_octants & 0x004) {\n        this.computeOctantX(1, -1);\n      }\n\n      if (opt_octants & 0x008) {\n        this.computeOctantY(1, -1);\n      }\n\n      if (opt_octants & 0x010) {\n        this.computeOctantY(-1, -1);\n      }\n\n      if (opt_octants & 0x020) {\n        this.computeOctantX(-1, -1);\n      }\n\n      if (opt_octants & 0x040) {\n        this.computeOctantX(-1, 1);\n      }\n\n      if (opt_octants & 0x080) {\n        this.computeOctantY(-1, 1);\n      }\n    }\n  }\n\n  /**\n   * All visible tiles are marked as explored.\n   */\n  updateExplored(): void {\n    for (let y = this.minY; y <= this.maxY; y++) {\n      for (let x = this.minX; x <= this.maxX; x++) {\n        const tile = this.grid[y][x];\n        tile.explored = tile.explored || tile.visible;\n      }\n    }\n  }\n}\n","export class Font {\n  readonly url: string;\n  readonly charWidth: number;\n  readonly charHeight: number;\n  readonly scale: number;\n\n  constructor(url: string, charWidth: number, charHeight: number, scale?: number) {\n    this.url = url;\n    this.charWidth = charWidth;\n    this.charHeight = charHeight;\n    this.scale = scale || 1.0;\n  }\n}\n\n/**\n * Font image as data URL.\n * IBM terminal font.\n * See img/font.png.\n */\nconst FONT_IMAGE =\n  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAQ' +\n  'MAAAD58POIAAAABlBMVEUAAAD///+l2Z/dAAAEhklEQVRIx42Sv4oUQRDGC4UzadSwwMUD8' +\n  'QEKlbWD4Q58B/NGpTVocKO1wXHUzMAH0AcwMTYVGg5ag0IzEXaRjdZEZKNzkKbHqtnzHypY' +\n  '09M9+5uvqr7pbYCuC6ftaRhgONXs30eAh0O1rYDm4IS/eH0B8GxRW2vxo396yu/fb0ZFrW1' +\n  'zcOXlPU/XPwK8PGjbWhVwM4KnH61912oK4+zmmHJaQotyt1kvtC2Atdo24iohPDiG/v4eIC' +\n  'JsY3Wy8Yvr0DSIBOdxgH6v8wsriWhc8s0AtaK/GzSl1jR0nSjQnwki6FQxNFKjgzO2a7BBq' +\n  'ucH7dL4M9z96CIhT1Fs/AgKgcA6dKCxI29DaHNwRJ4EGAU1sU0OG9rmE4SIc3A4FChACqqh' +\n  'JRwpxkqh9wxag4DSmEJ5DtpFwAP4GUf6lmKcFFti1BYuQp4xN8kxM2kNhjdkTOiTUeAKGvh' +\n  'A1rLpMbYACQzCITlTDRMbLYoEa2JWPSMRFZIupcSzMVKcEUkX+sOG+ChNX2vD8ex6k7OFHL' +\n  '0P1655JuPd53WAD+yTv3UrCQiuHmYBbfIxpkImuvpBQBkVb5g4XHv3JkNireG8AO9zDhBZu' +\n  '2z2OMZ11S5/RIlyMefMNaZ4GsCz5xcjyM6hHYEjAYEfO8Ig1rklAe9sRIeYAdwyoIBq6YIz' +\n  'CAKiWoifA3m3o2AzWcdYKOdY47EIf8QABCuYgIUVmdVMEYEDA0Hmo/3D6KKJbh5mxhP3UsW' +\n  'IE97wnEygyizOfOLi2JOJW8CeOblW9IHeKZgv4zxuzDryOmb+4aQH+MXV6e0ywdUcxqCjBW' +\n  'l5GpbzZduOG1QEiGXP86T7EfiJfkMQ4OO4H0yqyNC2zlziWEN7Ywuc2fQ4p5BNkS5QYXP2h' +\n  '5NtRJh0vCKQidtVJmCGAwDSSQpYggSxiRIyzewsgCh4xxiTPDMh5aj//l7btqkr6rQyIOtL' +\n  'ji4lVRQwXdzvus40Y53M33fh50GZwF4ExQeMlvuTggLzSi4ElKczUO7zVtpwdyMKdqZKOWb' +\n  '2nDblawPxPmuMwFEWBW+jlZR1eYtS442kiBGMWCi/h1/+GAR6NYOJWiqNJXFygFtrkx5C0O' +\n  '3IeFGs67HhEEhmBu/BUOT+0551pXxYIF+Elpi5AKRkLl5GUbCCZddyMv621ujEBPP4vSy2f' +\n  'otTx3U+d3WBiFOA6VSGSB49v/M7GBX9FPrDaT2c9qr4PCpwZ7qz813R94dVFIe19v33GlMZ' +\n  'UghQFb8BrfE7QBmgBMbrn2B3enn/y3B5+DL8UBAdnejdYdBxeV9ejwoYNTgW0Ok/gA7UG2G' +\n  'AzanhL0DG7q4svynwF8UwDPu7u/vD0IudzSltMtVbP+J/gUbR29oJ7Fg9s6Uy+DnpiTCOYc' +\n  '4cXOeXMWfsusSw7FOg9x655nax6BlecwpOQQ68WBwp+H2LMQTuOq2RUigzh2Q/R3CWARJIJ' +\n  'G199EwOTyKBlQMznshCRGeQ5gHABAQl6M4gLEdAzVaBWMCiANdsayDCHBA/hagKYfielrJI' +\n  'lipKKQIA9Nf3wBloTHT6BuAx15zRNa1nAAAAAElFTkSuQmCC';\n\nexport const DEFAULT_FONT = new Font(FONT_IMAGE, 8, 8);\n","/**\n * The FovOctants constants provide bitmasks for various directions.\n *\n *     \\ 4 | 3 /\n *      \\  |  /\n *    5  \\ | /  2\n *        \\|/\n *   ------+-------\n *        /|\\\n *    6  / | \\  1\n *      /  |  \\\n *     / 7 | 0 \\\n *\n */\nexport enum FovOctants {\n  OCTANT_SOUTH_SOUTHEAST = 0x001,\n  OCTANT_EAST_SOUTHEAST = 0x002,\n  OCTANT_EAST_NORTHTHEAST = 0x004,\n  OCTANT_NORTH_NORTHEAST = 0x008,\n  OCTANT_NORTH_NORTHWEST = 0x010,\n  OCTANT_WEST_NORTHEAST = 0x020,\n  OCTANT_WEST_SOUTHWEST = 0x040,\n  OCTANT_SOUTH_SOUTHWEST = 0x080,\n}\n\nexport enum FovQuadrants {\n  QUADRANT_SOUTHEAST = 0x001 + 0x002,\n  QUADRANT_EAST = 0x002 + 0x004,\n  QUADRANT_NORTHEAST = 0x004 + 0x008,\n  QUADRANT_NORTH = 0x008 + 0x010,\n  QUADRANT_NORTHWEST = 0x010 + 0x020,\n  QUADRANT_WEST = 0x020 + 0x040,\n  QUADRANT_SOUTHWEST = 0x040 + 0x080,\n  QUADRANT_SOUTH = 0x080 + 0x001,\n}\n\nexport function getFovQuadrant(dx: number, dy: number): FovQuadrants {\n  if (dx > 0) {\n    if (dy > 0) {\n      return FovQuadrants.QUADRANT_SOUTHEAST;\n    } else if (dy === 0) {\n      return FovQuadrants.QUADRANT_EAST;\n    } else {\n      return FovQuadrants.QUADRANT_NORTHEAST;\n    }\n  } else if (dx < 0) {\n    if (dy > 0) {\n      return FovQuadrants.QUADRANT_SOUTHWEST;\n    } else if (dy === 0) {\n      return FovQuadrants.QUADRANT_WEST;\n    } else {\n      return FovQuadrants.QUADRANT_NORTHWEST;\n    }\n  } else {\n    if (dy > 0) {\n      return FovQuadrants.QUADRANT_SOUTH;\n    } else {\n      return FovQuadrants.QUADRANT_NORTH;\n    }\n  }\n}\n","import { serializable } from './serialize';\n\nexport interface PointLike {\n  readonly x: number;\n  readonly y: number;\n}\n\n@serializable\nexport class Point implements PointLike {\n  readonly x: number;\n  readonly y: number;\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n}\n","import { Point } from './point';\nimport { serializable } from './serialize';\n\n@serializable\nexport class Rect {\n  readonly x: number;\n  readonly y: number;\n  readonly width: number;\n  readonly height: number;\n  readonly left: number;\n  readonly top: number;\n  readonly x2: number;\n  readonly y2: number;\n\n  constructor(x: number, y: number, width: number, height: number) {\n    this.x = this.left = x;\n    this.y = this.top = y;\n    this.width = width;\n    this.height = height;\n    this.x2 = x + width;\n    this.y2 = y + height;\n  }\n\n  getCenter(): Point {\n    return new Point((this.x + this.width / 2) | 0, (this.y + this.height / 2) | 0);\n  }\n\n  intersects(other: Rect): boolean {\n    return this.x <= other.x2 && this.x2 >= other.x && this.y <= other.y2 && this.y2 >= other.y;\n  }\n\n  contains(point: Point | Rect): boolean {\n    return point.x >= this.x && point.x < this.x2 && point.y >= this.y && point.y < this.y2;\n  }\n}\n","import { Console } from '../console';\nimport { Point } from '../point';\nimport { Rect } from '../rect';\nimport { Dialog } from './dialog';\n\nexport class DialogState {\n  readonly dialog: Dialog;\n  readonly rect: Rect;\n  readonly contentsOffset: Point;\n  open: boolean;\n  count: number;\n  buffer?: Console;\n\n  constructor(dialog: Dialog, rect: Rect, contentsOffset: Point) {\n    this.dialog = dialog;\n    this.rect = rect;\n    this.contentsOffset = contentsOffset;\n    this.open = false;\n    this.count = 0;\n  }\n}\n","import { Colors } from '../palettes/colors';\nimport { Point } from '../point';\nimport { Rect } from '../rect';\nimport { Terminal } from '../terminal';\nimport { Dialog } from './dialog';\nimport { DialogState } from './dialogstate';\n\nexport class DefaultDialogRenderer {\n  getState(terminal: Terminal, dialog: Dialog): DialogState {\n    const width = dialog.contentsRect.width + 4;\n    const height = dialog.contentsRect.height + 4;\n    const x = ((terminal.width - width) / 2) | 0;\n    const y = ((terminal.height - height) / 2) | 0;\n    return new DialogState(dialog, new Rect(x, y, width, height), new Point(x + 2, y + 2));\n  }\n\n  draw(term: Terminal, dialogState: DialogState): void {\n    const dialog = dialogState.dialog;\n    const { x, y, width, height } = dialogState.rect;\n    term.fillRect(x, y, width, height, 0, Colors.WHITE, Colors.BLACK);\n    term.drawSingleBox(x, y, width, height);\n    term.drawCenteredString((x + width / 2) | 0, y, ' ' + dialog.title + ' ');\n    dialog.drawContents(term, dialogState.contentsOffset);\n  }\n}\n","import { DefaultDialogRenderer } from './gui/defaultdialogrenderer';\nimport { Dialog } from './gui/dialog';\nimport { DialogRenderer } from './gui/dialogrenderer';\nimport { DialogState } from './gui/dialogstate';\nimport { Terminal } from './terminal';\n\nexport class GUI {\n  readonly terminal: Terminal;\n  readonly renderer: DialogRenderer;\n  readonly dialogs: DialogState[];\n\n  constructor(terminal: Terminal, renderer?: DialogRenderer) {\n    this.terminal = terminal;\n    this.renderer = renderer || new DefaultDialogRenderer();\n    this.dialogs = [];\n  }\n\n  add(dialog: Dialog): void {\n    this.dialogs.push(this.renderer.getState(this.terminal, dialog));\n  }\n\n  /**\n   * Handles input for currently active dialog.\n   * Returns true if the input was handled.\n   * Returns false otherwise.\n   */\n  handleInput(): boolean {\n    if (this.dialogs.length === 0) {\n      return false;\n    }\n\n    const activeIndex = this.dialogs.length - 1;\n    const activeState = this.dialogs[this.dialogs.length - 1];\n    const activeDialog = activeState.dialog;\n    if (activeDialog.handleInput(this.terminal, activeState.contentsOffset)) {\n      this.dialogs.splice(activeIndex, 1);\n    }\n\n    return true;\n  }\n\n  draw(): void {\n    for (let i = 0; i < this.dialogs.length; i++) {\n      this.renderer.draw(this.terminal, this.dialogs[i]);\n    }\n  }\n}\n","import { Console } from '../console';\nimport { Point } from '../point';\nimport { Rect } from '../rect';\nimport { Terminal } from '../terminal';\n\nexport abstract class Dialog {\n  readonly contentsRect: Rect;\n  readonly title: string;\n\n  constructor(contentsRect: Rect, title: string) {\n    this.contentsRect = contentsRect;\n    this.title = title;\n  }\n\n  abstract drawContents(console: Console, offset: Point): void;\n\n  abstract handleInput(terminal: Terminal, offset: Point): boolean;\n}\n","import { Color } from '../color';\nimport { serializable } from '../serialize';\n\n@serializable\nexport class Message {\n  constructor(\n    readonly text: string | undefined,\n    readonly fg?: Color | undefined,\n    readonly bg?: Color | undefined,\n    readonly children?: Message[]\n  ) {}\n\n  getWidth(): number {\n    let width = 0;\n\n    if (this.text) {\n      for (const line of this.text.split('\\n')) {\n        width = Math.max(width, line.length);\n      }\n    }\n\n    if (this.children) {\n      for (const child of this.children) {\n        width = Math.max(width, child.getWidth());\n      }\n    }\n\n    return width;\n  }\n\n  getHeight(): number {\n    let result = 0;\n\n    if (this.text) {\n      result += this.text.split('\\n').length;\n    }\n\n    if (this.children) {\n      for (const child of this.children) {\n        result += child.getHeight();\n      }\n    }\n\n    return result;\n  }\n}\n","/**\n * The delay in frames before input repeating.\n * Time in milliseconds.\n */\nconst INPUT_REPEAT_DELAY = 200.0;\n\n/**\n * The delay between subsequent repeat firing.\n * Time in milliseconds.\n */\nconst INPUT_REPEAT_RATE = 1000.0 / 15.0;\n\n/**\n * The Input class represents a pysical input.\n * Example: keyboard key or mouse button.\n */\nexport class Input {\n  down: boolean;\n  downTime: number;\n  repeat: boolean;\n  repeatTime: number;\n  downCount: number;\n  upCount: number;\n\n  constructor() {\n    this.down = false;\n    this.downTime = 0;\n    this.repeat = false;\n    this.repeatTime = 0;\n    this.downCount = 0;\n    this.upCount = 100;\n  }\n\n  setDown(down: boolean): void {\n    if (this.down !== down) {\n      this.down = down;\n      this.repeat = false;\n      this.downTime = this.repeatTime = performance.now();\n    }\n  }\n\n  update(time: number): void {\n    this.repeat = false;\n    if (this.down) {\n      this.downCount++;\n      this.upCount = 0;\n      if (time - this.downTime >= INPUT_REPEAT_DELAY && time - this.repeatTime >= INPUT_REPEAT_RATE) {\n        this.repeat = true;\n        this.repeatTime = time;\n      }\n    } else {\n      this.downCount = 0;\n      this.upCount++;\n    }\n  }\n\n  /**\n   * Returns true if the input is \"pressed\".\n   * Pressed is a one time event when the input first goes down.\n   * It then repeats on repeat delay.\n   */\n  isPressed(): boolean {\n    return this.downCount === 1 || this.repeat;\n  }\n\n  /**\n   * Returns true if the input is \"clicked\".\n   * Clicked is a one time event when the input first goes up.\n   */\n  isClicked(): boolean {\n    return this.upCount === 1;\n  }\n}\n\nexport class InputSet<T> {\n  readonly inputs = new Map<T, Input>();\n\n  clear(): void {\n    this.inputs.clear();\n  }\n\n  get(key: T): Input {\n    let input = this.inputs.get(key);\n    if (!input) {\n      input = new Input();\n      this.inputs.set(key, input);\n    }\n    return input;\n  }\n\n  updateAll(time: number): void {\n    this.inputs.forEach((input) => input.update(time));\n  }\n}\n","import { Input, InputSet } from './input';\n\nexport class Keyboard {\n  readonly keys = new InputSet<Key>();\n\n  /**\n   * Creates a new keyboard module.\n   *\n   * @param el DOM el to attach listeners.\n   */\n  constructor(el: HTMLElement) {\n    el.addEventListener('keydown', (e) => this.setKey(e, true));\n    el.addEventListener('keyup', (e) => this.setKey(e, false));\n  }\n\n  clear(): void {\n    this.keys.clear();\n  }\n\n  getKey(key: Key): Input {\n    return this.keys.get(key);\n  }\n\n  setKey(e: KeyboardEvent, state: boolean): void {\n    const key = e.code as Key;\n    if (key === Key.VK_F11) {\n      // Allow fullscreen requests to go through\n      return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n    this.keys.get(key).setDown(state);\n  }\n\n  updateKeys(time: number): void {\n    this.keys.updateAll(time);\n  }\n}\n\nexport enum Key {\n  VK_CANCEL = 'Pause',\n  VK_BACKSPACE = 'Backspace',\n  VK_TAB = 'Tab',\n  VK_ENTER = 'Enter',\n  VK_SHIFT_LEFT = 'ShiftLeft',\n  VK_SHIFT_RIGHT = 'ShiftLeft',\n  VK_CONTROL_LEFT = 'ControlLeft',\n  VK_CONTROL_RIGHT = 'ControlRight',\n  VK_ALT_LEFT = 'AltLeft',\n  VK_ALT_RIGHT = 'AltRight',\n  VK_PAUSE = 'Pause',\n  VK_CAPS_LOCK = 'CapsLock',\n  VK_ESCAPE = 'Escape',\n  VK_SPACE = 'Space',\n  VK_PAGE_UP = 'PageUp',\n  VK_PAGE_DOWN = 'PageDown',\n  VK_END = 'End',\n  VK_HOME = 'Home',\n  VK_LEFT = 'ArrowLeft',\n  VK_UP = 'ArrowUp',\n  VK_RIGHT = 'ArrowRight',\n  VK_DOWN = 'ArrowDown',\n  VK_INSERT = 'Insert',\n  VK_DELETE = 'Delete',\n  VK_0 = 'Digit0',\n  VK_1 = 'Digit1',\n  VK_2 = 'Digit2',\n  VK_3 = 'Digit3',\n  VK_4 = 'Digit4',\n  VK_5 = 'Digit5',\n  VK_6 = 'Digit6',\n  VK_7 = 'Digit7',\n  VK_8 = 'Digit8',\n  VK_9 = 'Digit9',\n  VK_SEMICOLON = 'Semicolon',\n  VK_EQUALS = 'Equal',\n  VK_A = 'KeyA',\n  VK_B = 'KeyB',\n  VK_C = 'KeyC',\n  VK_D = 'KeyD',\n  VK_E = 'KeyE',\n  VK_F = 'KeyF',\n  VK_G = 'KeyG',\n  VK_H = 'KeyH',\n  VK_I = 'KeyI',\n  VK_J = 'KeyJ',\n  VK_K = 'KeyK',\n  VK_L = 'KeyL',\n  VK_M = 'KeyM',\n  VK_N = 'KeyN',\n  VK_O = 'KeyO',\n  VK_P = 'KeyP',\n  VK_Q = 'KeyQ',\n  VK_R = 'KeyR',\n  VK_S = 'KeyS',\n  VK_T = 'KeyT',\n  VK_U = 'KeyU',\n  VK_V = 'KeyV',\n  VK_W = 'KeyW',\n  VK_X = 'KeyX',\n  VK_Y = 'KeyY',\n  VK_Z = 'KeyZ',\n  VK_CONTEXT_MENU = 'ContextMenu',\n  VK_NUMPAD0 = 'Numpad0',\n  VK_NUMPAD1 = 'Numpad1',\n  VK_NUMPAD2 = 'Numpad2',\n  VK_NUMPAD3 = 'Numpad3',\n  VK_NUMPAD4 = 'Numpad4',\n  VK_NUMPAD5 = 'Numpad5',\n  VK_NUMPAD6 = 'Numpad6',\n  VK_NUMPAD7 = 'Numpad7',\n  VK_NUMPAD8 = 'Numpad8',\n  VK_NUMPAD9 = 'Numpad9',\n  VK_NUMPAD_ENTER = 'NumpadEnter',\n  VK_MULTIPLY = 'NumpadMultiply',\n  VK_ADD = 'NumpadAdd',\n  VK_SEPARATOR = 'NumpadDecimal',\n  VK_SUBTRACT = 'NumpadSubtract',\n  VK_DECIMAL = 'NumpadDecimal',\n  VK_DIVIDE = 'NumpadDivide',\n  VK_F1 = 'F1',\n  VK_F2 = 'F2',\n  VK_F3 = 'F3',\n  VK_F4 = 'F4',\n  VK_F5 = 'F5',\n  VK_F6 = 'F6',\n  VK_F7 = 'F7',\n  VK_F8 = 'F8',\n  VK_F9 = 'F9',\n  VK_F10 = 'F10',\n  VK_F11 = 'F11',\n  VK_F12 = 'F12',\n  VK_F13 = 'F13',\n  VK_F14 = 'F14',\n  VK_F15 = 'F15',\n  VK_F16 = 'F16',\n  VK_F17 = 'F17',\n  VK_F18 = 'F18',\n  VK_F19 = 'F19',\n  VK_F20 = 'F20',\n  VK_F21 = 'F21',\n  VK_F22 = 'F22',\n  VK_F23 = 'F23',\n  VK_F24 = 'F24',\n  VK_NUM_LOCK = 'NumLock',\n  VK_SCROLL_LOCK = 'ScrollLock',\n  VK_COMMA = 'Comma',\n  VK_PERIOD = 'Period',\n  VK_SLASH = 'Slash',\n  VK_BACKQUOTE = 'Backquote',\n  VK_OPEN_BRACKET = 'BracketLeft',\n  VK_BACK_SLASH = 'Backslash',\n  VK_CLOSE_BRACKET = 'BracketRight',\n  VK_QUOTE = 'Quote',\n  VK_META = 'OSLeft',\n}\n","import { Console } from '../console';\nimport { Key } from '../keys';\nimport { Point } from '../point';\nimport { Rect } from '../rect';\nimport { Terminal } from '../terminal';\nimport { Dialog } from './dialog';\nimport { Message } from './message';\n\nexport class MessageDialog extends Dialog {\n  constructor(title: string, readonly message: string | Message) {\n    let rect;\n    if (message instanceof Message) {\n      rect = new Rect(0, 0, message.getWidth(), message.getHeight());\n    } else {\n      rect = new Rect(0, 0, message.length, 1);\n    }\n    super(rect, title);\n  }\n\n  drawContents(console: Console, offset: Point): void {\n    if (this.message instanceof Message) {\n      console.drawMessage(offset.x, offset.y, this.message);\n    } else {\n      console.drawString(offset.x, offset.y, this.message);\n    }\n  }\n\n  handleInput(terminal: Terminal): boolean {\n    return terminal.isKeyPressed(Key.VK_ESCAPE);\n  }\n}\n","import { Chars } from '../chars';\nimport { Console } from '../console';\nimport { Key } from '../keys';\nimport { Point } from '../point';\nimport { Rect } from '../rect';\nimport { Terminal } from '../terminal';\nimport { Dialog } from './dialog';\nimport { Message } from './message';\n\nexport class ScrollableMessageDialog extends Dialog {\n  readonly messagesHeight: number;\n  readonly scrollMax: number;\n  readonly scrollbarHeight: number;\n  scrollY = 0;\n\n  constructor(rect: Rect, title: string, readonly message: Message) {\n    super(rect, title);\n    this.messagesHeight = message.getHeight();\n    this.scrollMax = Math.max(1, this.messagesHeight - this.contentsRect.height);\n    this.scrollbarHeight = (this.contentsRect.height * this.contentsRect.height) / (this.messagesHeight + 1);\n  }\n\n  drawContents(console: Console, offset: Point): void {\n    console.clip = this.contentsRect;\n    console.drawMessage(offset.x, offset.y - this.scrollY, this.message);\n    console.clip = undefined;\n\n    // Draw scrollbar\n    const scrollbarY = (this.scrollY / this.scrollMax) * (this.contentsRect.height - this.scrollbarHeight);\n    console.drawVLine(\n      this.contentsRect.x + this.contentsRect.width + 1,\n      this.contentsRect.y + scrollbarY,\n      this.scrollbarHeight,\n      Chars.MEDIUM_SHADE\n    );\n  }\n\n  handleInput(terminal: Terminal): boolean {\n    const moveKey = terminal.getMovementKey();\n    if (moveKey) {\n      this.scrollY += moveKey.y;\n    }\n    if (terminal.isKeyPressed(Key.VK_PAGE_DOWN)) {\n      this.scrollY += this.contentsRect.height;\n    }\n    if (terminal.isKeyPressed(Key.VK_PAGE_UP)) {\n      this.scrollY -= this.contentsRect.height;\n    }\n    if (terminal.mouse.wheelDeltaY !== 0) {\n      this.scrollY += terminal.mouse.wheelDeltaY < 0 ? -5 : 5;\n      terminal.mouse.wheelDeltaY = 0;\n    }\n    this.scrollY = Math.max(0, Math.min(this.scrollMax, this.scrollY));\n    return terminal.isKeyPressed(Key.VK_ESCAPE);\n  }\n}\n","import { Console } from '../console';\nimport { Key } from '../keys';\nimport { Colors } from '../palettes/colors';\nimport { Point } from '../point';\nimport { Rect } from '../rect';\nimport { Terminal } from '../terminal';\nimport { Dialog } from './dialog';\n\nexport class SelectDialog extends Dialog {\n  readonly options: string[];\n  readonly callback: (i: number) => void;\n  private hoverIndex: number;\n\n  constructor(title: string, options: string[], callback: (i: number) => void) {\n    let width = title.length;\n    for (let i = 0; i < options.length; i++) {\n      width = Math.max(width, options[i].length + 4);\n    }\n\n    const height = options.length;\n    const rect = new Rect(0, 0, width, height);\n    super(rect, title);\n    this.options = options;\n    this.callback = callback;\n    this.hoverIndex = -1;\n  }\n\n  drawContents(console: Console, offset: Point): void {\n    for (let i = 0; i < this.options.length; i++) {\n      const str = String.fromCharCode(65 + i) + ' - ' + this.options[i];\n      if (i === this.hoverIndex) {\n        console.drawString(offset.x, offset.y + i, str, Colors.BLACK, Colors.WHITE);\n      } else {\n        console.drawString(offset.x, offset.y + i, str, Colors.WHITE, Colors.BLACK);\n      }\n    }\n  }\n\n  handleInput(terminal: Terminal, offset: Point): boolean {\n    const moveKey = terminal.getMovementKey();\n    if (moveKey && moveKey.y !== 0) {\n      this.hoverIndex = (this.hoverIndex + this.options.length + moveKey.y) % this.options.length;\n    }\n    if (this.hoverIndex >= 0 && (terminal.isKeyPressed(Key.VK_ENTER) || terminal.isKeyPressed(Key.VK_NUMPAD_ENTER))) {\n      this.callback(this.hoverIndex);\n      return true;\n    }\n    if (\n      terminal.mouse.x >= offset.x &&\n      terminal.mouse.x < offset.x + this.contentsRect.width &&\n      terminal.mouse.y >= offset.y &&\n      terminal.mouse.y < offset.y + this.contentsRect.height\n    ) {\n      this.hoverIndex = terminal.mouse.y - offset.y;\n      if (terminal.mouse.buttons.get(0).isClicked()) {\n        terminal.mouse.buttons.clear();\n        this.callback(this.hoverIndex);\n        return true;\n      }\n    }\n    const startCharCode = 'A'.charCodeAt(0);\n    for (let i = 0; i < this.options.length; i++) {\n      if (terminal.isKeyPressed(('Key' + String.fromCharCode(startCharCode + i)) as Key)) {\n        this.callback(i);\n        return true;\n      }\n    }\n    return terminal.isKeyPressed(Key.VK_ESCAPE);\n  }\n\n  isMouseOverOption(terminal: Terminal, offset: Point, index: number): boolean {\n    return (\n      terminal.mouse.x >= offset.x &&\n      terminal.mouse.x < offset.x + this.contentsRect.width &&\n      terminal.mouse.y === offset.y + index\n    );\n  }\n}\n","import { Cell } from './cell';\nimport { Chars } from './chars';\nimport { Color, fromRgb } from './color';\nimport { Console } from './console';\n\n/**\n * All available 2x2 patterns for 2x image loading.\n * Note: The strict IBM CGA font only has halves, not quadrants.\n */\nconst PATTERNS = [\n  { charCode: Chars.BLOCK_TOP_HALF, active: [1, 1, 0, 0] },\n  { charCode: Chars.BLOCK_RIGHT_HALF, active: [0, 1, 0, 1] },\n];\n\nexport function loadImage(url: string, callback: (img: Console) => void): void {\n  const img = new Image();\n  img.onload = () => {\n    const w = img.width;\n    const h = img.height;\n    const data = getImageData(img);\n    const result = new Console(w, h);\n    let i = 0;\n\n    for (let y = 0; y < h; y++) {\n      for (let x = 0; x < w; x++) {\n        const cell = result.getCell(x, y) as Cell;\n        cell.setBackground(fromRgb(data[i++], data[i++], data[i++], data[i++]));\n      }\n    }\n\n    callback(result);\n  };\n  img.src = url;\n}\n\nexport function loadImage2x(url: string, callback: (img: Console) => void): void {\n  const img = new Image();\n  img.onload = () => {\n    const w = img.width;\n    const h = img.height;\n    const data = getImageData(img);\n    const result = new Console(w / 2, h / 2);\n\n    for (let y = 0; y < h; y += 2) {\n      for (let x = 0; x < w; x += 2) {\n        draw2x2(result, data, x, y, w);\n      }\n    }\n\n    callback(result);\n  };\n  img.src = url;\n}\n\nfunction getImageData(img: HTMLImageElement): Uint8ClampedArray {\n  const canvas = document.createElement('canvas');\n  canvas.width = img.width;\n  canvas.height = img.height;\n\n  const ctx = canvas.getContext('2d') as CanvasRenderingContext2D;\n  ctx.drawImage(img, 0, 0);\n\n  return ctx.getImageData(0, 0, img.width, img.height).data;\n}\n\nfunction draw2x2(con: Console, data: Uint8ClampedArray, x: number, y: number, w: number): void {\n  // Top left\n  const i1 = 4 * (y * w + x);\n  const r1 = data[i1];\n  const g1 = data[i1 + 1];\n  const b1 = data[i1 + 2];\n\n  // Top right\n  const i2 = 4 * (y * w + x + 1);\n  const r2 = data[i2];\n  const g2 = data[i2 + 1];\n  const b2 = data[i2 + 2];\n\n  // Bottom left\n  const i3 = 4 * ((y + 1) * w + x);\n  const r3 = data[i3];\n  const g3 = data[i3 + 1];\n  const b3 = data[i3 + 2];\n\n  // Bottom right\n  const i4 = 4 * ((y + 1) * w + x + 1);\n  const r4 = data[i4];\n  const g4 = data[i4 + 1];\n  const b4 = data[i4 + 2];\n\n  const colors = [\n    [r1, g1, b1],\n    [r2, g2, b2],\n    [r3, g3, b3],\n    [r4, g4, b4],\n  ];\n\n  // For each possible pattern, calculate the total error\n  // Find the pattern with minum error\n\n  let minError = Number.MAX_VALUE;\n  let bestCharCode = 0;\n  let bestBg = null;\n  let bestFg = null;\n\n  for (let i = 0; i < PATTERNS.length; i++) {\n    const pattern = PATTERNS[i];\n    const patternColors = computeColors(pattern.active, colors);\n    if (patternColors.error < minError) {\n      minError = patternColors.error;\n      bestCharCode = pattern.charCode;\n      bestBg = patternColors.bg;\n      bestFg = patternColors.fg;\n    }\n  }\n\n  con.drawChar(x / 2, y / 2, bestCharCode, arrayToColor(bestFg as number[]), arrayToColor(bestBg as number[]));\n}\n\nfunction computeColors(pattern: number[], colors: number[][]): { error: number; bg: number[]; fg: number[] } {\n  const sum = [\n    [0, 0, 0],\n    [0, 0, 0],\n  ];\n  const avg = [\n    [0, 0, 0],\n    [0, 0, 0],\n  ];\n  const count = [0, 0];\n\n  for (let i = 0; i < 4; i++) {\n    for (let j = 0; j < 3; j++) {\n      sum[pattern[i]][j] += colors[i][j];\n    }\n    count[pattern[i]]++;\n  }\n\n  for (let i = 0; i < 2; i++) {\n    for (let j = 0; j < 3; j++) {\n      avg[i][j] = sum[i][j] / count[i];\n    }\n  }\n\n  let error = 0.0;\n\n  for (let i = 0; i < 4; i++) {\n    let cellError = 0.0;\n    for (let j = 0; j < 3; j++) {\n      const delta = colors[i][j] - avg[pattern[i]][j];\n      cellError += delta * delta;\n    }\n    error += Math.sqrt(cellError);\n  }\n\n  return { bg: avg[0], fg: avg[1], error };\n}\n\nfunction arrayToColor(rgb: number[]): Color {\n  return fromRgb(rgb[0], rgb[1], rgb[2]);\n}\n","import { InputSet } from './input';\nimport { Rect } from './rect';\nimport { Terminal } from './terminal';\n\nexport class Mouse {\n  readonly el: HTMLCanvasElement;\n  readonly width: number;\n  readonly height: number;\n  readonly buttons = new InputSet<number>();\n  private prevX: number;\n  private prevY: number;\n  x: number;\n  y: number;\n  dx: number;\n  dy: number;\n  wheelDeltaX: number;\n  wheelDeltaY: number;\n\n  constructor(terminal: Terminal) {\n    this.el = terminal.canvas;\n    this.width = terminal.width;\n    this.height = terminal.height;\n    this.prevX = 0;\n    this.prevY = 0;\n    this.x = 0;\n    this.y = 0;\n    this.dx = 0;\n    this.dy = 0;\n    this.wheelDeltaX = 0;\n    this.wheelDeltaY = 0;\n\n    const el = this.el;\n    el.addEventListener('mousedown', (e) => this.handleEvent(e));\n    el.addEventListener('mouseup', (e) => this.handleEvent(e));\n    el.addEventListener('mousemove', (e) => this.handleEvent(e));\n    el.addEventListener('contextmenu', (e) => this.handleEvent(e));\n    el.addEventListener('touchstart', (e) => this.handleTouchEvent(e));\n    el.addEventListener('touchend', (e) => this.handleTouchEvent(e));\n    el.addEventListener('touchcancel', (e) => this.handleTouchEvent(e));\n    el.addEventListener('touchmove', (e) => this.handleTouchEvent(e));\n    el.addEventListener('wheel', (e) => this.handleWheelEvent(e));\n  }\n\n  private handleTouchEvent(e: TouchEvent): void {\n    e.stopPropagation();\n    e.preventDefault();\n\n    if (e.touches.length > 0) {\n      const touch = e.touches[0];\n      this.updatePosition(touch.clientX, touch.clientY);\n      this.buttons.get(0).setDown(true);\n    } else {\n      this.buttons.get(0).setDown(false);\n    }\n  }\n\n  private handleEvent(e: MouseEvent): void {\n    e.stopPropagation();\n    e.preventDefault();\n\n    this.updatePosition(e.clientX, e.clientY);\n\n    if (e.type === 'mousedown') {\n      this.buttons.get(e.button).setDown(true);\n      this.el.focus();\n    }\n\n    if (e.type === 'mouseup') {\n      this.buttons.get(e.button).setDown(false);\n    }\n  }\n\n  private handleWheelEvent(e: WheelEvent): void {\n    e.stopPropagation();\n    e.preventDefault();\n    this.wheelDeltaX = e.deltaX;\n    this.wheelDeltaY = e.deltaY;\n  }\n\n  private updatePosition(clientX: number, clientY: number): void {\n    let rect: Rect | DOMRect = this.el.getBoundingClientRect();\n\n    // If the client rect is not the same aspect ratio as canvas,\n    // then we are fullscreen.\n    // Need to update client rect accordingly.\n\n    const terminalAspectRatio = this.width / this.height;\n    const rectAspectRatio = rect.width / rect.height;\n\n    if (rectAspectRatio - terminalAspectRatio > 0.01) {\n      const actualWidth = terminalAspectRatio * rect.height;\n      const excess = rect.width - actualWidth;\n      rect = new Rect(Math.floor(excess / 2), 0, actualWidth, rect.height);\n    }\n\n    if (rectAspectRatio - terminalAspectRatio < -0.01) {\n      const actualHeight = rect.width / terminalAspectRatio;\n      const excess = rect.height - actualHeight;\n      rect = new Rect(0, Math.floor(excess / 2), rect.width, actualHeight);\n    }\n\n    this.x = ((this.width * (clientX - rect.left)) / rect.width) | 0;\n    this.y = ((this.height * (clientY - rect.top)) / rect.height) | 0;\n  }\n\n  update(time: number): void {\n    this.dx = this.x - this.prevX;\n    this.dy = this.y - this.prevY;\n    this.prevX = this.x;\n    this.prevY = this.y;\n    this.buttons.updateAll(time);\n  }\n}\n","import { fromRgb } from '../color';\n\n/**\n * Commodore 64 palette.\n * See: https://www.c64-wiki.com/wiki/Color\n * See: https://lospec.com/palette-list/commodore64\n */\nexport const Commodore64Palette = {\n  BLACK: fromRgb(0, 0, 0),\n  WHITE: fromRgb(255, 255, 255),\n  RED: fromRgb(136, 0, 0),\n  CYAN: fromRgb(170, 255, 238),\n  VIOLET: fromRgb(204, 68, 204),\n  GREEN: fromRgb(0, 204, 85),\n  BLUE: fromRgb(0, 0, 170),\n  YELLOW: fromRgb(238, 238, 119),\n  ORANGE: fromRgb(221, 136, 85),\n  BROWN: fromRgb(102, 68, 0),\n  LIGHT_RED: fromRgb(255, 119, 119),\n  DARK_GRAY: fromRgb(51, 51, 51),\n  GRAY: fromRgb(119, 119, 119),\n  LIGHT_GREEN: fromRgb(170, 255, 102),\n  LIGHT_BLUE: fromRgb(0, 136, 255),\n  LIGHT_GRAY: fromRgb(187, 187, 187),\n};\n","import { fromRgb } from '../color';\n\n/**\n * Colodore palette.\n * Recalculated palette for the VIC II (Commodore 64) by Pepto.\n * See: https://www.pepto.de/projects/colorvic/\n * See: https://lospec.com/palette-list/colodore\n */\nexport const ColodorePalette = {\n  BLACK: fromRgb(0, 0, 0),\n  WHITE: fromRgb(255, 255, 255),\n  RED: fromRgb(136, 0, 0),\n  CYAN: fromRgb(170, 255, 238),\n  VIOLET: fromRgb(204, 68, 204),\n  GREEN: fromRgb(0, 204, 85),\n  BLUE: fromRgb(0, 0, 170),\n  YELLOW: fromRgb(238, 238, 119),\n  ORANGE: fromRgb(221, 136, 85),\n  BROWN: fromRgb(102, 68, 0),\n  LIGHT_RED: fromRgb(255, 119, 119),\n  DARK_GRAY: fromRgb(51, 51, 51),\n  GRAY: fromRgb(119, 119, 119),\n  LIGHT_GREEN: fromRgb(170, 255, 102),\n  LIGHT_BLUE: fromRgb(0, 136, 255),\n  LIGHT_GRAY: fromRgb(187, 187, 187),\n};\n","import { fromRgb } from '../color';\n\n/**\n * PICO 8 palette.\n * See: https://pico-8.fandom.com/wiki/Palette\n * See: https://lospec.com/palette-list/pico-8\n */\nexport const Pico8Palette = {\n  BLACK: fromRgb(0, 0, 0),\n  DARK_BLUE: fromRgb(29, 43, 83),\n  DARK_PURPLE: fromRgb(126, 37, 83),\n  DARK_GREEN: fromRgb(0, 135, 81),\n  BROWN: fromRgb(171, 82, 54),\n  DARK_GRAY: fromRgb(95, 87, 79),\n  LIGHT_GRAY: fromRgb(194, 195, 199),\n  WHITE: fromRgb(255, 241, 232),\n  RED: fromRgb(255, 0, 77),\n  ORANGE: fromRgb(255, 163, 0),\n  YELLOW: fromRgb(255, 236, 39),\n  GREEN: fromRgb(0, 228, 54),\n  BLUE: fromRgb(41, 173, 255),\n  LAVENDER: fromRgb(131, 118, 156),\n  PINK: fromRgb(255, 119, 168),\n  LIGHT_PEACH: fromRgb(255, 204, 170),\n};\n","import { Cell } from './cell';\nimport { Console } from './console';\nimport { PointLike } from './point';\n\nconst dxs = [-1, 0, 1, -1, 1, -1, 0, 1];\nconst dys = [-1, -1, -1, 0, 0, 1, 1, 1];\nconst costs = [1.4, 1, 1.4, 1, 1, 1.4, 1, 1.4];\nlet pathId = 0;\n\n/**\n * Calculates path between two points using Dijkstra's algorithm.\n *\n * @param source Starting point, must have x and y properties.\n * @param dest Destination point, must have x and y properties.\n * @param maxDist Maximum distance to examine.\n * @return Array of steps if destination found; undefined otherwise.\n */\nexport function computePath(map: Console, source: PointLike, dest: PointLike, maxDist: number): Cell[] | undefined {\n  pathId++;\n\n  const sourceCell = map.grid[source.y][source.x];\n  sourceCell.pathId = pathId;\n  sourceCell.g = 0.0;\n  sourceCell.h = Math.hypot(source.x - dest.x, source.y - dest.y);\n  sourceCell.prev = null;\n\n  const q = new SortedSet([sourceCell]);\n\n  while (q.size() > 0) {\n    const u = q.pop() as Cell;\n\n    if (u.x === dest.x && u.y === dest.y) {\n      return buildPath(u);\n    }\n\n    for (let i = 0; i < dxs.length; i++) {\n      const x = u.x + dxs[i];\n      const y = u.y + dys[i];\n      if (x >= 0 && x < map.width && y >= 0 && y < map.height) {\n        const v = map.grid[y][x];\n        if (v.blocked && v.explored && (x !== dest.x || y !== dest.y)) {\n          continue;\n        }\n        if (v.pathId !== pathId) {\n          v.pathId = pathId;\n          v.g = Infinity;\n          v.h = Math.hypot(x - dest.x, y - dest.y);\n          v.prev = null;\n        }\n        const alt = u.g + costs[i];\n        if (alt < v.g && alt <= maxDist) {\n          v.g = alt;\n          v.prev = u;\n          q.insert(v);\n        }\n      }\n    }\n  }\n  return undefined;\n}\n\nfunction buildPath(cell: Cell): Cell[] {\n  const result = [];\n  let curr: Cell | null = cell;\n  while (curr) {\n    result.push(curr);\n    curr = curr.prev;\n  }\n  result.reverse();\n  return result;\n}\n\nclass SortedSet {\n  private readonly values: Cell[];\n\n  constructor(initialValues: Cell[]) {\n    this.values = initialValues;\n  }\n\n  insert(cell: Cell): void {\n    const array = this.values;\n    let low = 0;\n    let high = array.length;\n    let index = 0;\n\n    while (low < high) {\n      const mid = (low + high) >>> 1;\n      const midCell = array[mid];\n      if (midCell.g + midCell.h > cell.g + cell.h) {\n        low = mid + 1;\n        index = low;\n      } else {\n        high = mid;\n        index = high;\n      }\n    }\n    array.splice(index, 0, cell);\n  }\n\n  pop(): Cell | undefined {\n    return this.values.pop();\n  }\n\n  size(): number {\n    return this.values.length;\n  }\n}\n","import { serializable } from './serialize';\n\n/**\n * Random number generator.\n *\n * LCG\n * https://stackoverflow.com/a/424445/2051724\n */\n@serializable\nexport class RNG {\n  private m: number;\n  private a: number;\n  private c: number;\n  private state: number;\n\n  /**\n   * Creates a new random number generator.\n   *\n   * @param seed The integer seed.\n   */\n  constructor(seed?: number) {\n    // LCG using GCC's constants\n    this.m = 0x80000000; // 2**31;\n    this.a = 1103515245;\n    this.c = 12345;\n    this.state = seed || 1;\n  }\n\n  nextInt(): number {\n    this.state = (this.a * this.state + this.c) % this.m;\n    return this.state;\n  }\n\n  /**\n   * Returns a floating point number between 0.0 and 1.0.\n   */\n  nextFloat(): number {\n    // returns in range [0,1]\n    return this.nextInt() / (this.m - 1);\n  }\n\n  /**\n   * Returns an integer in the range start (inclusive) to end (exclusive).\n   * @param start Lower bound, inclusive.\n   * @param end Upper bound, exclusive.\n   */\n  nextRange(start: number, end: number): number {\n    // returns in range [start, end): including start, excluding end\n    // can't modulu nextInt because of weak randomness in lower bits\n    const rangeSize = end - start;\n    const randomUnder1 = this.nextInt() / this.m;\n    const result = start + ((randomUnder1 * rangeSize) | 0);\n    if (isNaN(result)) {\n      throw new Error('rand nan');\n    }\n    return result;\n  }\n\n  chooseIndex(chances: number[]): number {\n    const total = chances.reduce((a, b) => a + b);\n    const roll = this.nextRange(1, total + 1);\n    let runningTotal = 0;\n\n    for (let i = 0; i < chances.length; i++) {\n      runningTotal += chances[i];\n      if (roll <= runningTotal) {\n        return i;\n      }\n    }\n\n    return chances.length - 1;\n  }\n\n  chooseKey(chancesMap: Record<string, number>): string {\n    const values = Object.keys(chancesMap);\n    const chances = values.map((value) => chancesMap[value]);\n    return values[this.chooseIndex(chances)];\n  }\n}\n","/**\n * Vertex shader program.\n *\n * a = attribute vec2 aVertexPosition;\n * b = attribute vec2 aTextureCoord;\n * c = attribute vec3 aFgColor;\n * d = attribute vec3 aBgColor;\n * e = varying vec2 vTextureCoord;\n * f = varying vec4 vFgColor;\n * g = varying vec4 vBgColor;\n */\nexport const VERTEX_SHADER_SOURCE =\n  '#version 300 es\\n' +\n  'precision highp float;' +\n  'in vec2 a;' +\n  'in vec2 b;' +\n  'in vec3 c;' +\n  'in vec3 d;' +\n  'out vec2 e;' +\n  'out vec4 f;' +\n  'out vec4 g;' +\n  'void main(void){' +\n  'gl_Position=vec4(a.x,a.y,0,1);' +\n  'e=b/16.0;' +\n  'f=vec4(c.r,c.g,c.b,1);' +\n  'g=vec4(d.r,d.g,d.b,1);' +\n  '}';\n\n/**\n * Fragment shader program.\n *\n * e = varying vec2 vTextureCoord;\n * f = varying vec4 vFgColor;\n * g = varying vec4 vBgColor;\n * s = uniform sampler2D uSampler;\n * o = out vec4 oColor;\n */\nexport const FRAGMENT_SHADER_SOURCE =\n  '#version 300 es\\n' +\n  'precision highp float;' +\n  'in vec2 e;' +\n  'in vec4 f;' +\n  'in vec4 g;' +\n  'uniform sampler2D s;' +\n  'out vec4 o;' +\n  'void main(void){' +\n  'o=texture(s,e);' +\n  // Using ASCII characters\n  'if(o.r<0.1) {' +\n  // Black background, so use bgColor\n  'o=g;' +\n  '} else {' +\n  // White background, so use fgColor\n  'o=f;' +\n  '}' +\n  '}';\n\nexport const CRT_VERTEX_SHADER_SOURCE = `#version 300 es\nprecision highp float;\nin vec2 a_position;\nin vec2 a_texCoord;\nout vec2 v_texCoord;\nvoid main(void) {\n  gl_Position=vec4(a_position.x, a_position.y, 0.0, 1.0);\n  v_texCoord = a_texCoord;\n}`;\n\nexport const CRT_FRAGMENT_SHADER_SOURCE = `#version 300 es\n#define PI 3.1415926535897932384626433832795\nprecision highp float;\nin vec2 v_texCoord;\nuniform sampler2D u_texture;\nuniform float u_blur;\nuniform float u_curvature;\nuniform float u_chroma;\nuniform float u_scanlineWidth;\nuniform float u_scanlineIntensity;\nuniform float u_vignette;\nout vec4 outputColor;\n\nvec2 curve(vec2 uv) {\n  uv = (uv - 0.5) * 2.0;\n  uv *= 1.1;\n  uv.x *= 1.0 + pow((abs(uv.y) * u_curvature), 2.0);\n  uv.y *= 1.0 + pow((abs(uv.x) * u_curvature), 2.0);\n  uv /= 1.1;\n  uv = (uv / 2.0) + 0.5;\n  return uv;\n}\n\nvoid main() {\n  vec2 iResolution = vec2(640.0, 360.0);\n  vec2 q = v_texCoord;\n  vec2 fragCoord = v_texCoord;\n  vec2 uv = q;\n  uv = curve(uv);\n\n  // Outside of range is black\n  if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n    outputColor = vec4(0.0, 0.0, 0.0, 1.0);\n    return;\n  }\n\n  vec4 col;\n\n  // Chromatic aberration\n  // col = texture(u_texture, uv.xy);\n  col.r = 0.7 * texture(u_texture, vec2(uv.x + 0.001 * u_chroma, uv.y + 0.001 * u_chroma)).r;\n  col.g = 0.7 * texture(u_texture, vec2(uv.x + 0.000 * u_chroma, uv.y - 0.002 * u_chroma)).g;\n  col.b = 0.7 * texture(u_texture, vec2(uv.x - 0.002 * u_chroma, uv.y + 0.000 * u_chroma)).b;\n  \n  // Blur\n  col += 0.05 * texture(u_texture, vec2(uv.x - 2.0 * u_blur / iResolution.x, uv.y));\n  col += 0.10 * texture(u_texture, vec2(uv.x - 1.0 * u_blur / iResolution.x, uv.y));\n  col += 0.10 * texture(u_texture, vec2(uv.x + 1.0 * u_blur / iResolution.x, uv.y));\n  col += 0.05 * texture(u_texture, vec2(uv.x + 2.0 * u_blur / iResolution.x, uv.y));\n\n  // Vignette\n  col *= pow(16.0 * uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y), u_vignette);\n\n  // Scanlines\n  col *= clamp(1.0 + u_scanlineWidth * sin(uv.y * iResolution.y * 2.0 * PI), 1.0 - u_scanlineIntensity, 1.0);\n\n  outputColor = vec4(col.rgb, 1.0);\n}`;\n","import { Cell } from './cell';\nimport { Console } from './console';\nimport { DEFAULT_FONT, Font } from './font';\nimport { Key, Keyboard } from './keys';\nimport { Mouse } from './mouse';\nimport { Point } from './point';\nimport {\n  CRT_FRAGMENT_SHADER_SOURCE,\n  CRT_VERTEX_SHADER_SOURCE,\n  FRAGMENT_SHADER_SOURCE,\n  VERTEX_SHADER_SOURCE,\n} from './shaders';\n\n/**\n * Linearly interpolates a number in the range 0-max to -1.0-1.0.\n *\n * @param i The value between 0 and max.\n * @param max The maximum value.\n * @returns The interpolated value between -1.0 and 1.0.\n */\nfunction interpolate(i: number, max: number): number {\n  return -1.0 + 2.0 * (i / max);\n}\n\ninterface TerminalOptions {\n  font?: Font;\n  crt?: CrtOptions;\n  maxFps?: number;\n}\n\ninterface CrtOptions {\n  scale: number;\n  blur: number;\n  curvature: number;\n  chroma: number;\n  vignette: number;\n  scanlineWidth: number;\n  scanlineIntensity: number;\n}\n\nconst DEFAULT_OPTIONS = {\n  font: DEFAULT_FONT,\n};\n\nexport class Terminal extends Console {\n  readonly canvas: HTMLCanvasElement;\n  readonly font: Font;\n  readonly crt?: CrtOptions;\n  readonly maxFps?: number;\n  readonly pixelWidth: number;\n  readonly pixelHeight: number;\n  readonly pixelScale: number;\n  readonly keys: Keyboard;\n  readonly mouse: Mouse;\n  readonly gl: WebGLRenderingContext;\n  readonly program: WebGLProgram;\n  readonly positionAttribLocation: number;\n  readonly textureAttribLocation: number;\n  readonly fgColorAttribLocation: number;\n  readonly bgColorAttribLocation: number;\n  readonly positionsArray: Float32Array;\n  readonly indexArray: Uint16Array;\n  readonly textureArray: Float32Array;\n  readonly foregroundUint8Array: Uint8Array;\n  readonly foregroundDataView: DataView;\n  readonly backgroundUint8Array: Uint8Array;\n  readonly backgroundDataView: DataView;\n  readonly positionBuffer: WebGLBuffer;\n  readonly indexBuffer: WebGLBuffer;\n  readonly textureBuffer: WebGLBuffer;\n  readonly foregroundBuffer: WebGLBuffer;\n  readonly backgroundBuffer: WebGLBuffer;\n  readonly texture: WebGLTexture;\n  readonly frameBufferTexture: WebGLTexture;\n  readonly frameBuffer: WebGLFramebuffer;\n  readonly crtProgram: WebGLProgram;\n  readonly crtBlurLocation: WebGLUniformLocation;\n  readonly crtCurvatureLocation: WebGLUniformLocation;\n  readonly crtChromaLocation: WebGLUniformLocation;\n  readonly crtScanlineWidthLocation: WebGLUniformLocation;\n  readonly crtScanlineIntensityLocation: WebGLUniformLocation;\n  readonly crtVignetteLocation: WebGLUniformLocation;\n  readonly crtPositionLocation: number;\n  readonly crtTexCoordLocation: number;\n  readonly crtPositionBuffer: WebGLBuffer;\n  readonly crtTexCoordBuffer: WebGLBuffer;\n  private lastRenderTime: number;\n  private renderDelta: number;\n  fps: number;\n  averageFps: number;\n  update?: () => void;\n\n  constructor(canvas: HTMLCanvasElement, width: number, height: number, options?: TerminalOptions) {\n    super(width, height);\n\n    options = options || DEFAULT_OPTIONS;\n\n    this.canvas = canvas;\n    this.font = options.font || DEFAULT_FONT;\n    this.crt = options.crt;\n    this.maxFps = options.maxFps;\n    this.pixelWidth = width * this.font.charWidth;\n    this.pixelHeight = height * this.font.charHeight;\n    this.pixelScale = options.crt?.scale || 1.0;\n\n    canvas.width = this.pixelWidth * this.pixelScale;\n    canvas.height = this.pixelHeight * this.pixelScale;\n    canvas.style.imageRendering = 'pixelated';\n    canvas.style.outline = 'none';\n    canvas.tabIndex = 0;\n    this.handleResize();\n    window.addEventListener('resize', () => this.handleResize());\n\n    this.keys = new Keyboard(canvas);\n    this.mouse = new Mouse(this);\n\n    // Get the WebGL context from the canvas\n    const gl = canvas.getContext('webgl2', { antialias: false });\n    if (!gl) {\n      throw new Error('Unable to initialize WebGL. Your browser may not support it.');\n    }\n\n    const program = gl.createProgram();\n    if (!program) {\n      throw new Error('Unable to initialize WebGL. Your browser may not support it.');\n    }\n\n    this.gl = gl;\n    this.program = program;\n\n    gl.attachShader(program, this.buildShader(gl.VERTEX_SHADER, VERTEX_SHADER_SOURCE));\n    gl.attachShader(program, this.buildShader(gl.FRAGMENT_SHADER, FRAGMENT_SHADER_SOURCE));\n    gl.linkProgram(program);\n    gl.useProgram(program);\n\n    this.crtProgram = gl.createProgram() as WebGLProgram;\n    gl.attachShader(this.crtProgram, this.buildShader(gl.VERTEX_SHADER, CRT_VERTEX_SHADER_SOURCE));\n    gl.attachShader(this.crtProgram, this.buildShader(gl.FRAGMENT_SHADER, CRT_FRAGMENT_SHADER_SOURCE));\n    gl.linkProgram(this.crtProgram);\n    gl.useProgram(this.crtProgram);\n\n    this.crtBlurLocation = gl.getUniformLocation(this.crtProgram, 'u_blur') as WebGLUniformLocation;\n    this.crtCurvatureLocation = gl.getUniformLocation(this.crtProgram, 'u_curvature') as WebGLUniformLocation;\n    this.crtChromaLocation = gl.getUniformLocation(this.crtProgram, 'u_chroma') as WebGLUniformLocation;\n    this.crtScanlineWidthLocation = gl.getUniformLocation(this.crtProgram, 'u_scanlineWidth') as WebGLUniformLocation;\n    this.crtScanlineIntensityLocation = gl.getUniformLocation(\n      this.crtProgram,\n      'u_scanlineIntensity'\n    ) as WebGLUniformLocation;\n    this.crtVignetteLocation = gl.getUniformLocation(this.crtProgram, 'u_vignette') as WebGLUniformLocation;\n\n    this.crtPositionLocation = gl.getAttribLocation(this.crtProgram, 'a_position');\n    this.crtPositionBuffer = gl.createBuffer() as WebGLBuffer;\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.crtPositionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1]), gl.STATIC_DRAW);\n    gl.enableVertexAttribArray(this.crtPositionLocation);\n    gl.vertexAttribPointer(this.crtPositionLocation, 2, gl.FLOAT, false, 0, 0);\n\n    this.crtTexCoordLocation = gl.getAttribLocation(this.crtProgram, 'a_texCoord');\n    this.crtTexCoordBuffer = gl.createBuffer() as WebGLBuffer;\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.crtTexCoordBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1]), gl.STATIC_DRAW);\n    gl.enableVertexAttribArray(this.crtTexCoordLocation);\n    gl.vertexAttribPointer(this.crtTexCoordLocation, 2, gl.FLOAT, false, 0, 0);\n\n    this.positionAttribLocation = this.getAttribLocation('a');\n    this.textureAttribLocation = this.getAttribLocation('b');\n    this.fgColorAttribLocation = this.getAttribLocation('c');\n    this.bgColorAttribLocation = this.getAttribLocation('d');\n\n    const cellCount = width * height;\n    this.positionsArray = new Float32Array(cellCount * 3 * 4);\n    this.indexArray = new Uint16Array(cellCount * 6);\n    this.textureArray = new Float32Array(cellCount * 2 * 4);\n    this.foregroundUint8Array = new Uint8Array(cellCount * 4 * 4);\n    this.foregroundDataView = new DataView(this.foregroundUint8Array.buffer);\n    this.backgroundUint8Array = new Uint8Array(cellCount * 4 * 4);\n    this.backgroundDataView = new DataView(this.backgroundUint8Array.buffer);\n\n    // Init the frame buffer\n    this.frameBufferTexture = gl.createTexture() as WebGLTexture;\n    gl.bindTexture(gl.TEXTURE_2D, this.frameBufferTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.pixelWidth, this.pixelHeight, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n    this.frameBuffer = gl.createFramebuffer() as WebGLFramebuffer;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.frameBufferTexture, 0);\n\n    // Init the positions buffer\n    let i = 0;\n    let j = 0;\n    let k = 0;\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        // Top-left\n        this.positionsArray[i++] = interpolate(x, width);\n        this.positionsArray[i++] = -interpolate(y, height);\n\n        // Top-right\n        this.positionsArray[i++] = interpolate(x + 1, width);\n        this.positionsArray[i++] = -interpolate(y, height);\n\n        // Bottom-right\n        this.positionsArray[i++] = interpolate(x + 1, width);\n        this.positionsArray[i++] = -interpolate(y + 1, height);\n\n        // Bottom-left\n        this.positionsArray[i++] = interpolate(x, width);\n        this.positionsArray[i++] = -interpolate(y + 1, height);\n\n        this.indexArray[j++] = k + 0;\n        this.indexArray[j++] = k + 1;\n        this.indexArray[j++] = k + 2;\n        this.indexArray[j++] = k + 0;\n        this.indexArray[j++] = k + 2;\n        this.indexArray[j++] = k + 3;\n\n        k += 4;\n      }\n    }\n\n    this.positionBuffer = gl.createBuffer() as WebGLBuffer;\n    this.indexBuffer = gl.createBuffer() as WebGLBuffer;\n    this.textureBuffer = gl.createBuffer() as WebGLBuffer;\n    this.foregroundBuffer = gl.createBuffer() as WebGLBuffer;\n    this.backgroundBuffer = gl.createBuffer() as WebGLBuffer;\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, this.positionsArray, gl.STATIC_DRAW);\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indexArray, gl.STATIC_DRAW);\n\n    this.texture = this.loadTexture(this.font.url);\n\n    this.lastRenderTime = 0;\n    this.renderDelta = 0;\n    this.fps = 0;\n    this.averageFps = 0;\n\n    if (this.maxFps === undefined) {\n      this.requestAnimationFrame();\n    } else {\n      window.setInterval(() => this.renderLoop(performance.now()), 1000 / this.maxFps);\n    }\n  }\n\n  private handleResize(): void {\n    const parent = this.canvas.parentElement;\n    if (!parent) {\n      return;\n    }\n    const widthFactor = parent.offsetWidth / this.pixelWidth;\n    const heightFactor = parent.offsetHeight / this.pixelHeight;\n    const factor = Math.min(widthFactor, heightFactor);\n    const width = (factor * this.pixelWidth) | 0;\n    const height = (factor * this.pixelHeight) | 0;\n    this.canvas.style.width = width + 'px';\n    this.canvas.style.height = height + 'px';\n  }\n\n  private getAttribLocation(name: string): number {\n    const location = this.gl.getAttribLocation(this.program, name);\n    this.gl.enableVertexAttribArray(location);\n    return location;\n  }\n\n  private flush(): void {\n    let textureArrayIndex = 0;\n    let colorArrayIndex = 0;\n\n    for (let y = 0; y < this.height; y++) {\n      for (let x = 0; x < this.width; x++) {\n        const cell = this.getCell(x, y) as Cell;\n\n        if (!cell.dirty) {\n          textureArrayIndex += 8;\n          colorArrayIndex += 16;\n          continue;\n        }\n\n        const textureX = cell.charCode % 16;\n        const textureY = (cell.charCode / 16) | 0;\n\n        this.textureArray[textureArrayIndex++] = textureX;\n        this.textureArray[textureArrayIndex++] = textureY;\n\n        this.textureArray[textureArrayIndex++] = textureX + 1;\n        this.textureArray[textureArrayIndex++] = textureY;\n\n        this.textureArray[textureArrayIndex++] = textureX + 1;\n        this.textureArray[textureArrayIndex++] = textureY + 1;\n\n        this.textureArray[textureArrayIndex++] = textureX;\n        this.textureArray[textureArrayIndex++] = textureY + 1;\n\n        for (let i = 0; i < 4; i++) {\n          this.foregroundDataView.setUint32(colorArrayIndex, cell.fg, false);\n          this.backgroundDataView.setUint32(colorArrayIndex, cell.bg, false);\n          colorArrayIndex += 4;\n        }\n\n        cell.dirty = false;\n      }\n    }\n  }\n\n  isKeyDown(key: Key): boolean {\n    return this.keys.getKey(key).down;\n  }\n\n  isKeyPressed(key: Key): boolean {\n    return this.keys.getKey(key).isPressed();\n  }\n\n  getKeyDownCount(key: Key): number {\n    return this.keys.getKey(key).downCount;\n  }\n\n  /**\n   * Returns a standard roguelike movement key if pressed.\n   * Implemented control systems:\n   * 1) Numpad arrows\n   * 2) VIM keys\n   * 3) Normal arrows (4 directions only)\n   * 4) Numpad 5 and '.' (period) for \"wait\"\n   * If a key is pressed, returns the movement delta.\n   * If no key is pressed, returns undefined.\n   * See: http://www.roguebasin.com/index.php?title=Preferred_Key_Controls\n   */\n  getMovementKey(): Point | undefined {\n    if (this.isKeyPressed(Key.VK_NUMPAD1) || this.isKeyPressed(Key.VK_B)) {\n      return new Point(-1, 1);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD2) || this.isKeyPressed(Key.VK_J) || this.isKeyPressed(Key.VK_DOWN)) {\n      return new Point(0, 1);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD3) || this.isKeyPressed(Key.VK_N)) {\n      return new Point(1, 1);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD4) || this.isKeyPressed(Key.VK_H) || this.isKeyPressed(Key.VK_LEFT)) {\n      return new Point(-1, 0);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD5) || this.isKeyPressed(Key.VK_PERIOD)) {\n      return new Point(0, 0);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD6) || this.isKeyPressed(Key.VK_L) || this.isKeyPressed(Key.VK_RIGHT)) {\n      return new Point(1, 0);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD7) || this.isKeyPressed(Key.VK_Y)) {\n      return new Point(-1, -1);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD8) || this.isKeyPressed(Key.VK_K) || this.isKeyPressed(Key.VK_UP)) {\n      return new Point(0, -1);\n    }\n    if (this.isKeyPressed(Key.VK_NUMPAD9) || this.isKeyPressed(Key.VK_U)) {\n      return new Point(1, -1);\n    }\n    return undefined;\n  }\n\n  private buildShader(type: number, source: string): WebGLShader {\n    const gl = this.gl;\n    const sh = gl.createShader(type);\n    if (!sh) {\n      throw new Error('An error occurred compiling the shader: ');\n    }\n    gl.shaderSource(sh, source);\n    gl.compileShader(sh);\n    if (!gl.getShaderParameter(sh, gl.COMPILE_STATUS)) {\n      throw new Error('An error occurred compiling the shader: ' + gl.getShaderInfoLog(sh));\n    }\n    return sh;\n  }\n\n  /**\n   * Initialize a texture and load an image.\n   * When the image finished loading copy it into the texture.\n   * @param url\n   */\n  private loadTexture(url: string): WebGLTexture {\n    const gl = this.gl;\n    const texture = gl.createTexture() as WebGLTexture;\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n\n    // Because images have to be download over the internet\n    // they might take a moment until they are ready.\n    // Until then put a single pixel in the texture so we can\n    // use it immediately. When the image has finished downloading\n    // we'll update the texture with the contents of the image.\n    const level = 0;\n    const internalFormat = gl.RGBA;\n    const width = 1;\n    const height = 1;\n    const border = 0;\n    const srcFormat = gl.RGBA;\n    const srcType = gl.UNSIGNED_BYTE;\n    const pixel = new Uint8Array([0, 0, 0, 255]); // opaque black\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, width, height, border, srcFormat, srcType, pixel);\n\n    const image = new Image();\n    image.onload = () => {\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, srcFormat, srcType, image);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    };\n    image.src = url;\n\n    return texture;\n  }\n\n  //\n  // Draw the scene.\n  //\n  private render(): void {\n    const gl = this.gl;\n    gl.clearColor(0.0, 0.0, 0.0, 1.0);\n    gl.clearDepth(1.0);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    if (this.crt) {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer);\n    } else {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    }\n    gl.viewport(0, 0, this.pixelWidth, this.pixelHeight);\n\n    // Tell WebGL how to pull out the positions from the position\n    // buffer into the vertexPosition attribute\n    {\n      const numComponents = 2;\n      const type = gl.FLOAT;\n      const normalize = false;\n      const stride = 0;\n      const offset = 0;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n      gl.vertexAttribPointer(this.positionAttribLocation, numComponents, type, normalize, stride, offset);\n    }\n\n    // Tell WebGL how to pull out the texture coordinates from\n    // the texture coordinate buffer into the textureCoord attribute.\n    {\n      const numComponents = 2;\n      const type = gl.FLOAT;\n      const normalize = false;\n      const stride = 0;\n      const offset = 0;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.textureBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.textureArray, gl.DYNAMIC_DRAW);\n      gl.vertexAttribPointer(this.textureAttribLocation, numComponents, type, normalize, stride, offset);\n    }\n\n    // Foreground color\n    {\n      const numComponents = 4;\n      const type = gl.UNSIGNED_BYTE;\n      const normalize = true;\n      const stride = 0;\n      const offset = 0;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.foregroundBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.foregroundUint8Array, gl.DYNAMIC_DRAW);\n      gl.vertexAttribPointer(this.fgColorAttribLocation, numComponents, type, normalize, stride, offset);\n    }\n\n    // Background color\n    {\n      const numComponents = 4;\n      const type = gl.UNSIGNED_BYTE;\n      const normalize = true;\n      const stride = 0;\n      const offset = 0;\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.backgroundBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, this.backgroundUint8Array, gl.DYNAMIC_DRAW);\n      gl.vertexAttribPointer(this.bgColorAttribLocation, numComponents, type, normalize, stride, offset);\n    }\n\n    // Tell WebGL which indices to use to index the vertices\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n\n    // Tell WebGL to use our program when drawing\n    gl.useProgram(this.program);\n\n    // Tell WebGL we want to affect texture unit 0\n    gl.activeTexture(gl.TEXTURE0);\n\n    // Bind the texture to texture unit 0\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n    // Tell the shader we bound the texture to texture unit 0\n    {\n      const vertexCount = this.width * this.height * 6;\n      const type = gl.UNSIGNED_SHORT;\n      const offset = 0;\n      gl.drawElements(gl.TRIANGLES, vertexCount, type, offset);\n    }\n  }\n\n  private renderCrt(): void {\n    const crt = this.crt;\n    if (!crt) {\n      return;\n    }\n    const gl = this.gl;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.viewport(0, 0, this.pixelWidth * this.pixelScale, this.pixelHeight * this.pixelScale);\n    gl.useProgram(this.crtProgram);\n    gl.uniform1f(this.crtBlurLocation, crt.blur);\n    gl.uniform1f(this.crtCurvatureLocation, crt.curvature);\n    gl.uniform1f(this.crtChromaLocation, crt.chroma);\n    gl.uniform1f(this.crtVignetteLocation, crt.vignette);\n    gl.uniform1f(this.crtScanlineWidthLocation, crt.scanlineWidth);\n    gl.uniform1f(this.crtScanlineIntensityLocation, crt.scanlineIntensity);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.crtPositionBuffer);\n    gl.vertexAttribPointer(this.crtPositionLocation, 2, gl.FLOAT, false, 0, 0);\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.crtTexCoordBuffer);\n    gl.vertexAttribPointer(this.crtTexCoordLocation, 2, gl.FLOAT, false, 0, 0);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this.frameBufferTexture);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  }\n\n  private requestAnimationFrame(): void {\n    window.requestAnimationFrame((t) => this.renderLoop(t));\n  }\n\n  private renderLoop(time: number): void {\n    if (this.lastRenderTime === 0) {\n      this.lastRenderTime = time;\n      this.fps = 0;\n    } else {\n      this.renderDelta = time - this.lastRenderTime;\n      this.lastRenderTime = time;\n      this.fps = 1000.0 / this.renderDelta;\n      this.averageFps = 0.95 * this.averageFps + 0.05 * this.fps;\n    }\n\n    this.keys.updateKeys(time);\n    this.mouse.update(time);\n    if (this.update) {\n      this.update();\n    }\n    this.flush();\n    this.render();\n    if (this.crt) {\n      this.renderCrt();\n    }\n    if (this.maxFps === undefined) {\n      this.requestAnimationFrame();\n    }\n  }\n}\n"],"names":["BlendMode","Cell","Chars","Console","FovOctants","FovQuadrants","Point","Rect","Message","Key","RNG"],"mappings":";;;;;;IAAA;;IAEG;AACSA,+BAuBX;IAvBD,CAAA,UAAY,SAAS,EAAA;IACnB;;IAEG;IACH,IAAA,SAAA,CAAA,SAAA,CAAA,MAAA,CAAA,GAAA,CAAA,CAAA,GAAA,MAAQ,CAAA;IAER;;;;;;IAMG;IACH,IAAA,SAAA,CAAA,SAAA,CAAA,OAAA,CAAA,GAAA,CAAA,CAAA,GAAA,OAAS,CAAA;IAET;;;;;;IAMG;IACH,IAAA,SAAA,CAAA,SAAA,CAAA,KAAA,CAAA,GAAA,CAAA,CAAA,GAAA,KAAO,CAAA;IACT,CAAC,EAvBWA,iBAAS,KAATA,iBAAS,GAuBpB,EAAA,CAAA,CAAA;;ICxBD;;;;IAIG;IACH,MAAM,gBAAgB,GAAG;IACvB,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACZ,IAAA,CAAC,CA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"}