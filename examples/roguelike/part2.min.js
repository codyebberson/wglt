!function(t,i){if("object"===typeof exports&&"object"===typeof module)module.t=i();else if("function"===typeof define&&define.amd)define([],i);else{var s=i();for(var h in s)("object"===typeof exports?exports:t)[h]=s[h]}}(window,(function(){return function(t){var i={};function s(h){if(i[h])return i[h].t;var e=i[h]={i:h,s:!1,t:{}};return t[h].call(e.t,e,e.t,s),e.s=!0,e.t}return s.h=t,s.c=i,s.d=function(t,i,h){s.o(t,i)||Object.defineProperty(t,i,{K:!0,get:h})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"_",{value:!0})},s.V=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t._)return t;var h=Object.create(null);if(s.r(h),Object.defineProperty(h,"default",{K:!0,value:t}),2&i&&"string"!=typeof t)for(var e in t)s.d(h,e,function(i){return t[i]}.bind(null,e));return h},s.n=function(t){var i=t&&t._?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.l="",s(s.u=0)}([function(t,i,s){"use strict";function h(t,i,s,h){return void 0===h&&(h=255),(t<<24)+(i<<16)+(s<<8)+h}s.r(i);const e={A:h(0,0,0),C:h(255,255,255),M:h(170,170,170),g:h(85,85,85),O:h(255,255,85),N:h(170,85,0),R:h(255,85,85),T:h(170,0,0),p:h(85,255,85),v:h(0,170,0),D:h(85,255,255),U:h(0,170,170),L:h(85,85,255),S:h(0,0,170),F:h(255,85,255),P:h(170,0,170),I:h(255,136,0)};class r{constructor(){this.B=!1,this.G=0,this.m=0}update(){this.B?(this.G++,this.m=0):(this.G=0,this.m++)}H(){const t=this.G;return 1===t||t>6&&t%1===0}Y(){return 1===this.m}}class o{constructor(t){this.keys=new Array(256);for(let t=0;t<256;t++)this.keys[t]=new r;t.addEventListener("keydown",t=>this.W(t,!0)),t.addEventListener("keyup",t=>this.W(t,!1))}W(t,i){const s=t.keyCode;s!==n.k&&(t.stopPropagation(),t.preventDefault(),s>=0&&s<256&&(this.keys[s].B=i))}J(){for(let t=0;t<256;t++)this.keys[t].update()}getKey(t){return t>=0&&t<256?this.keys[t]:null}}const n={j:3,X:6,q:8,Z:9,$:12,tt:13,it:16,st:17,ht:18,et:19,rt:20,ot:27,nt:32,Kt:33,_t:34,ct:35,Vt:36,at:37,lt:38,ut:39,At:40,ft:44,Et:45,dt:46,Ct:48,wt:49,Mt:50,gt:51,Ot:52,Nt:53,Rt:54,Tt:55,pt:56,vt:57,Dt:58,Ut:59,Lt:60,St:61,Ft:62,bt:63,yt:64,Pt:65,It:66,Bt:67,Gt:68,xt:69,Ht:70,Yt:71,Qt:72,zt:73,Wt:74,kt:75,Jt:76,jt:77,Xt:78,qt:79,Zt:80,$t:81,ti:82,ii:83,si:84,hi:85,ei:86,ri:87,oi:88,ni:89,Ki:90,_i:93,ci:96,Vi:97,ai:98,li:99,ui:100,Ai:101,fi:102,Ei:103,di:104,Ci:105,wi:106,Mi:107,gi:108,Oi:109,Ni:110,Ri:111,Ti:112,pi:113,vi:114,Di:115,Ui:116,Li:117,Si:118,Fi:119,bi:120,yi:121,k:122,Pi:123,Ii:124,Bi:125,Gi:126,mi:127,xi:128,Hi:129,Yi:130,Qi:131,zi:132,Wi:133,ki:134,Ji:135,ji:144,Xi:145,qi:160,Zi:161,$i:162,ts:163,ss:164,hs:165,es:166,rs:167,os:168,ns:169,Ks:170,_s:171,cs:172,Vs:173,as:174,ls:175,us:176,As:188,fs:190,Es:191,ds:192,Cs:219,ws:220,Ms:221,gs:222,Os:224,Ns:225,Rs:91,Ts:21,ps:21,vs:22,Ds:23,Us:24,Ls:25,Ss:25,Fs:28,bs:29,ys:30,Ps:31,Is:41,Bs:42,Gs:43,ms:95},K=0,_=1,c=2;class V{constructor(t,i,s,h){this.charCode=void 0!==t?function(t){return"string"===typeof t&&t.length>0?t.charCodeAt(0):t}(t):" ".charCodeAt(0),this.xs=void 0!==i?i:e.C,this.Hs=void 0!==s?s:e.A,void 0!==h&&(this.Ys=h),this.Qs=!0}zs(t){this.charCode!==t&&(this.charCode=t,this.Qs=!0)}Ws(t){void 0!==t&&null!==t&&t!==this.xs&&(this.xs=t,this.Qs=!0)}ks(t){void 0!==t&&null!==t&&t!==this.Hs&&(this.Hs=t,this.Qs=!0)}Js(t){void 0!==t&&(this.Ys=t,this.Qs=!0)}js(t,i,s,h){return"string"===typeof t&&(t=t.charCodeAt(0)),"number"===typeof t?(this.zs(t),this.Ws(i),this.ks(s),this.Js(h)):this.Xs(t,K),this.Qs}Xs(t,i){const s=255&t.Hs;i===K||t.charCode>0?(this.zs(t.charCode),this.Ws(t.xs)):s>0&&s<255&&this.Ws(this.qs(this.xs,t.Hs,i)),i===K||255===s?this.ks(t.Hs):s>0&&this.ks(this.qs(this.Hs,t.Hs,i)),this.Js(t.Ys)}qs(t,i,s){const e=(255-(255&i))/255,r=1-e,o=t>>24&255,n=t>>16&255,K=t>>8&255,V=i>>24&255,a=i>>16&255,l=i>>8&255;switch(s){case _:return h(e*o+r*V|0,e*n+r*a|0,e*K+r*l|0);case c:return h(this.Zs(o+r*V|0),this.Zs(n+r*a|0),this.Zs(K+r*l|0));default:return i}}Zs(t){return Math.min(255,t)}}const a=179,l=186,u=187,A=188,f=191,E=192,d=196,C=200,w=201,M=205,g=217,O=218;class N{constructor(t,i,s){this.width=t,this.height=i,this.$s=new Array;const h=s||V;for(let s=0;s<i;s++){const i=new Array;for(let e=0;e<t;e++)i.push(new h(e,s));this.$s.push(i)}this.clear()}clear(){for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++)this.th(i,t,0)}ih(t,i){if(!(t<0||i<0||t>=this.width||i>=this.height))return this.$s[i][t]}sh(t,i){if(!(t<0||i<0||t>=this.width||i>=this.height))return this.$s[i][t].charCode}th(t,i,s,h,e){t>=0&&t<this.width&&i>=0&&i<this.height&&this.$s[i][t].js(s,h,e)}hh(t,i,s,h,e){const r=s.split("\n");for(let s=0;s<r.length;s++){const o=r[s];for(let r=0;r<o.length;r++)this.th(t+r,i+s,o.charCodeAt(r),h,e)}}eh(t,i,s,h,e){this.hh(t-Math.floor(s.length/2),i,s,h,e)}rh(t,i,s,h,e,r){for(let o=t;o<t+s;o++)this.th(o,i,h,e,r)}oh(t,i,s,h,e,r){for(let o=i;o<i+s;o++)this.th(t,o,h,e,r)}nh(t,i,s,h,e,r,o){this.rh(t,i,s,e,r,o),this.rh(t,i+h-1,s,e,r,o),this.oh(t,i,h,e,r,o),this.oh(t+s-1,i,h,e,r,o)}Kh(t,i,s,h,e,r,o,n,K,_,c,V,a,l){this.fillRect(t,i,s,h,0,a,l),this.rh(t,i,s,e),this.rh(t,i+h-1,s,o),this.oh(t,i,h,n),this.oh(t+s-1,i,h,r),this.th(t,i,K),this.th(t+s-1,i,_),this.th(t,i+h-1,V),this.th(t+s-1,i+h-1,c)}_h(t,i,s,h,e,r){this.Kh(t,i,s,h,d,a,d,a,O,f,g,E,e,r)}Vh(t,i,s,h,e,r){this.Kh(t,i,s,h,M,l,M,l,w,u,A,C,e,r)}fillRect(t,i,s,h,e,r,o){for(let n=i;n<i+h;n++)this.rh(t,n,s,e,r,o)}ah(t,i,s,h,e,r,o,n){n=n||K;for(let K=0;K<o;K++)for(let o=0;o<r;o++){const r=s.ih(h+o,e+K);r&&this.Xs(t+o,i+K,r,n)}}Xs(t,i,s,h){t>=0&&t<this.width&&i>=0&&i<this.height&&this.$s[i][t].Xs(s,h)}}const R=new class{constructor(t,i,s,h,e){this.url=t,this.lh=i,this.uh=s,this.scale=h||1,this.Ah=!!e}}("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAQMAAAD58POIAAAABlBMVEUAAAD///+l2Z/dAAAEhklEQVRIx42Sv4oUQRDGC4UzadSwwMUD8QEKlbWD4Q58B/NGpTVocKO1wXHUzMAH0AcwMTYVGg5ag0IzEXaRjdZEZKNzkKbHqtnzHypY09M9+5uvqr7pbYCuC6ftaRhgONXs30eAh0O1rYDm4IS/eH0B8GxRW2vxo396yu/fb0ZFrW1zcOXlPU/XPwK8PGjbWhVwM4KnH61912oK4+zmmHJaQotyt1kvtC2Atdo24iohPDiG/v4eICJsY3Wy8Yvr0DSIBOdxgH6v8wsriWhc8s0AtaK/GzSl1jR0nSjQnwki6FQxNFKjgzO2a7BBqucH7dL4M9z96CIhT1Fs/AgKgcA6dKCxI29DaHNwRJ4EGAU1sU0OG9rmE4SIc3A4FChACqqhJRwpxkqh9wxag4DSmEJ5DtpFwAP4GUf6lmKcFFti1BYuQp4xN8kxM2kNhjdkTOiTUeAKGvhA1rLpMbYACQzCITlTDRMbLYoEa2JWPSMRFZIupcSzMVKcEUkX+sOG+ChNX2vD8ex6k7OFHL0P1655JuPd53WAD+yTv3UrCQiuHmYBbfIxpkImuvpBQBkVb5g4XHv3JkNireG8AO9zDhBZu2z2OMZ11S5/RIlyMefMNaZ4GsCz5xcjyM6hHYEjAYEfO8Ig1rklAe9sRIeYAdwyoIBq6YIzCAKiWoifA3m3o2AzWcdYKOdY47EIf8QABCuYgIUVmdVMEYEDA0Hmo/3D6KKJbh5mxhP3UsWIE97wnEygyizOfOLi2JOJW8CeOblW9IHeKZgv4zxuzDryOmb+4aQH+MXV6e0ywdUcxqCjBWl5GpbzZduOG1QEiGXP86T7EfiJfkMQ4OO4H0yqyNC2zlziWEN7Ywuc2fQ4p5BNkS5QYXP2h5NtRJh0vCKQidtVJmCGAwDSSQpYggSxiRIyzewsgCh4xxiTPDMh5aj//l7btqkr6rQyIOtLji4lVRQwXdzvus40Y53M33fh50GZwF4ExQeMlvuTggLzSi4ElKczUO7zVtpwdyMKdqZKOWb2nDblawPxPmuMwFEWBW+jlZR1eYtS442kiBGMWCi/h1/+GAR6NYOJWiqNJXFygFtrkx5C0O3IeFGs67HhEEhmBu/BUOT+0551pXxYIF+Elpi5AKRkLl5GUbCCZddyMv621ujEBPP4vSy2fotTx3U+d3WBiFOA6VSGSB49v/M7GBX9FPrDaT2c9qr4PCpwZ7qz813R94dVFIe19v33GlMZUghQFb8BrfE7QBmgBMbrn2B3enn/y3B5+DL8UBAdnejdYdBxeV9ejwoYNTgW0Ok/gA7UG2GAzanhL0DG7q4svynwF8UwDPu7u/vD0IudzSltMtVbP+J/gUbR29oJ7Fg9s6Uy+DnpiTCOYc4cXOeXMWfsusSw7FOg9x655nax6BlecwpOQQ68WBwp+H2LMQTuOq2RUigzh2Q/R3CWARJIJG199EwOTyKBlQMznshCRGeQ5gHABAQl6M4gLEdAzVaBWMCiANdsayDCHBA/hagKYfielrJIlipKKQIA9Nf3wBloTHT6BuAx15zRNa1nAAAAAElFTkSuQmCC",8,8);class T{constructor(t,i){this.x=t,this.y=i}}class p{constructor(t,i,s,h){this.x=this.left=t,this.y=this.top=i,this.width=s,this.height=h,this.x2=t+s,this.y2=i+h}fh(){return new T(this.x+this.width/2|0,this.y+this.height/2|0)}Eh(t){return this.x<=t.x2&&this.x2>=t.x&&this.y<=t.y2&&this.y2>=t.y}contains(t){return t.x>=this.x&&t.y<this.x2&&t.y>=this.y&&t.y<this.y2}}class v{constructor(t,i){this.dh=t.canvas,this.width=t.width,this.height=t.height,this.options=i,this.Ch=0,this.wh=0,this.x=0,this.y=0,this.dx=0,this.dy=0,this.buttons=[new r,new r,new r];const s=this.dh;s.addEventListener("mousedown",t=>this.Mh(t)),s.addEventListener("mouseup",t=>this.Mh(t)),s.addEventListener("mousemove",t=>this.Mh(t)),s.addEventListener("contextmenu",t=>this.Mh(t));const h=this.gh.bind(this);s.addEventListener("touchstart",h),s.addEventListener("touchend",h),s.addEventListener("touchcancel",h),s.addEventListener("touchmove",h)}gh(t){if(t.stopPropagation(),t.preventDefault(),"touchend"===t.type&&this.options.requestFullscreen&&this.requestFullscreen(),t.touches.length>0){const i=t.touches[0];this.Oh(i.clientX,i.clientY),this.buttons[0].B=!0}else this.buttons[0].B=!1}Mh(t){t.stopPropagation(),t.preventDefault(),this.Oh(t.clientX,t.clientY),"mousedown"===t.type&&(this.buttons[t.button].B=!0,this.dh.focus(),this.options.requestFullscreen&&this.requestFullscreen()),"mouseup"===t.type&&(this.buttons[t.button].B=!1)}Oh(t,i){let s=this.dh.getBoundingClientRect();const h=this.width/this.height,e=s.width/s.height;if(e-h>.01){const t=h*s.height,i=s.width-t;s=new p(Math.floor(i/2),0,t,s.height)}if(e-h<-.01){const t=s.width/h,i=s.height-t;s=new p(0,Math.floor(i/2),s.width,t)}this.x=this.width*(t-s.left)/s.width|0,this.y=this.height*(i-s.top)/s.height|0}requestFullscreen(){const t=this.dh;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen&&t.mozRequestFullScreen()}update(){this.dx=this.x-this.Ch,this.dy=this.y-this.wh,this.Ch=this.x,this.wh=this.y;for(let t=0;t<this.buttons.length;t++)this.buttons[t].update()}}function D(t,i){return t/i*2-1}const U={font:R,requestFullscreen:!1};class L extends V{constructor(t,i){super(),this.x=t,this.y=i,this.Nh=!1,this.Rh=!1,this.Th=!1,this.visible=!1,this.ph=-1,this.vh=0,this.Dh=0,this.Uh=null}}const S=h(0,0,100),F=h(50,50,150);class b{constructor(t,i,s,h){this.x=t,this.y=i,this.char=s,this.color=h}move(t,i){G.$s[this.y+i][this.x+t].Nh||(this.x+=t,this.y+=i)}Lh(){y.hh(this.x,this.y,this.char,this.color)}}const y=new class extends N{constructor(t,i,s,h){super(i,s),h=h||U,this.canvas=t,this.font=h.font||R,this.pixelWidth=i*this.font.lh,this.pixelHeight=s*this.font.uh,t.width=this.pixelWidth,t.height=this.pixelHeight,t.style.width=this.font.scale*this.pixelWidth+"px",t.style.height=this.font.scale*this.pixelHeight+"px",t.style.imageRendering="pixelated",t.style.outline="none",t.tabIndex=0,this.Sh(),window.addEventListener("resize",()=>this.Sh()),this.keys=new o(t),this.Fh=new v(this,h);const e=t.getContext("webgl",{bh:!1});if(!e)throw new Error("Unable to initialize WebGL. Your browser may not support it.");const r=e.createProgram();if(!r)throw new Error("Unable to initialize WebGL. Your browser may not support it.");this.yh=e,this.Ph=r,e.attachShader(r,this.Ih(e.VERTEX_SHADER,"attribute vec2 a;attribute vec2 b;attribute vec3 c;attribute vec3 d;varying highp vec2 e;varying highp vec4 f;varying highp vec4 g;void main(void){gl_Position=vec4(a.x,a.y,0,1);e=b/16.0;f=vec4(c.r,c.g,c.b,1);g=vec4(d.r,d.g,d.b,1);}")),e.attachShader(r,this.Ih(e.FRAGMENT_SHADER,"varying highp vec2 e;varying highp vec4 f;varying highp vec4 g;uniform bool h;uniform sampler2D s;void main(void){gl_FragColor=texture2D(s,e);if(h){if(gl_FragColor.a<0.1){gl_FragColor=texture2D(s,g.rg*16.0+fract(e*16.0)/16.0);}}else{if(gl_FragColor.r<0.1) {gl_FragColor=g;} else {gl_FragColor=f;}}}")),e.linkProgram(r),e.useProgram(r),this.font.Ah&&e.uniform1i(e.getUniformLocation(r,"h"),1),this.Bh=this.getAttribLocation("a"),this.Gh=this.getAttribLocation("b"),this.mh=this.getAttribLocation("c"),this.xh=this.getAttribLocation("d");const n=i*s;this.Hh=new Float32Array(3*n*4),this.Yh=new Uint16Array(6*n),this.Qh=new Float32Array(2*n*4),this.zh=new Uint8Array(4*n*4),this.Wh=new DataView(this.zh.buffer),this.kh=new Uint8Array(4*n*4),this.Jh=new DataView(this.kh.buffer);let K=0,_=0,c=0;for(let t=0;t<s;t++)for(let h=0;h<i;h++)this.Hh[K++]=D(h,i),this.Hh[K++]=-D(t,s),this.Hh[K++]=D(h+1,i),this.Hh[K++]=-D(t,s),this.Hh[K++]=D(h+1,i),this.Hh[K++]=-D(t+1,s),this.Hh[K++]=D(h,i),this.Hh[K++]=-D(t+1,s),this.Yh[_++]=c+0,this.Yh[_++]=c+1,this.Yh[_++]=c+2,this.Yh[_++]=c+0,this.Yh[_++]=c+2,this.Yh[_++]=c+3,c+=4;this.jh=e.createBuffer(),this.Xh=e.createBuffer(),this.qh=e.createBuffer(),this.Zh=e.createBuffer(),this.$h=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.jh),e.bufferData(e.ARRAY_BUFFER,this.Hh,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.Xh),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.Yh,e.STATIC_DRAW),this.te=this.ie(this.font.url),window.setInterval(()=>this.se(),1e3/30)}Sh(){const t=this.canvas.parentElement.offsetWidth/this.pixelWidth,i=this.canvas.parentElement.offsetHeight/this.pixelHeight,s=Math.min(t,i),h=s*this.pixelWidth|0,e=s*this.pixelHeight|0;this.canvas.style.width=h+"px",this.canvas.style.height=e+"px"}getAttribLocation(t){const i=this.yh.getAttribLocation(this.Ph,t);return this.yh.enableVertexAttribArray(i),i}flush(){let t=0,i=0;for(let s=0;s<this.height;s++)for(let h=0;h<this.width;h++){const e=this.ih(h,s);if(!e.Qs){t+=8,i+=16;continue}const r=e.charCode%16,o=e.charCode/16|0;this.Qh[t++]=r,this.Qh[t++]=o,this.Qh[t++]=r+1,this.Qh[t++]=o,this.Qh[t++]=r+1,this.Qh[t++]=o+1,this.Qh[t++]=r,this.Qh[t++]=o+1;for(let t=0;t<4;t++)this.Wh.setUint32(i,e.xs,!1),this.Jh.setUint32(i,e.Hs,!1),i+=4;e.Qs=!1}}he(t){const i=this.keys.getKey(t);return i&&i.B}ee(t){const i=this.keys.getKey(t);return i&&i.H()}re(t){const i=this.keys.getKey(t);return i?i.G:0}Ih(t,i){const s=this.yh,h=s.createShader(t);if(!h)throw new Error("An error occurred compiling the shader: ");if(s.shaderSource(h,i),s.compileShader(h),!s.getShaderParameter(h,s.COMPILE_STATUS))throw new Error("An error occurred compiling the shader: "+s.getShaderInfoLog(h));return h}ie(t){const i=this.yh,s=i.createTexture();i.bindTexture(i.TEXTURE_2D,s);const h=i.RGBA,e=i.RGBA,r=i.UNSIGNED_BYTE,o=new Uint8Array([0,0,0,255]);i.texImage2D(i.TEXTURE_2D,0,h,1,1,0,e,r,o);const n=new Image;return n.onload=()=>{i.bindTexture(i.TEXTURE_2D,s),i.texImage2D(i.TEXTURE_2D,0,h,e,r,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)},n.src=t,s}oe(){const t=this.yh;t.clearColor(0,0,0,1),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.viewport(0,0,this.pixelWidth,this.pixelHeight);{const i=2,s=t.FLOAT,h=!1,e=0,r=0;t.bindBuffer(t.ARRAY_BUFFER,this.jh),t.vertexAttribPointer(this.Bh,i,s,h,e,r)}{const i=2,s=t.FLOAT,h=!1,e=0,r=0;t.bindBuffer(t.ARRAY_BUFFER,this.qh),t.bufferData(t.ARRAY_BUFFER,this.Qh,t.DYNAMIC_DRAW),t.vertexAttribPointer(this.Gh,i,s,h,e,r)}{const i=4,s=t.UNSIGNED_BYTE,h=!0,e=0,r=0;t.bindBuffer(t.ARRAY_BUFFER,this.Zh),t.bufferData(t.ARRAY_BUFFER,this.zh,t.DYNAMIC_DRAW),t.vertexAttribPointer(this.mh,i,s,h,e,r)}{const i=4,s=t.UNSIGNED_BYTE,h=!0,e=0,r=0;t.bindBuffer(t.ARRAY_BUFFER,this.$h),t.bufferData(t.ARRAY_BUFFER,this.kh,t.DYNAMIC_DRAW),t.vertexAttribPointer(this.xh,i,s,h,e,r)}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.Xh),t.useProgram(this.Ph),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.te);{const i=this.width*this.height*6,s=t.UNSIGNED_SHORT,h=0;t.drawElements(t.TRIANGLES,i,s,h)}}se(){this.keys.J(),this.Fh.update(),this.update&&this.update(),this.state&&this.state.update(),this.flush(),this.oe()}}(document.querySelector("canvas"),80,45),P=new b(40,25,"@",e.C),I=new b(40,20,"@",e.O),B=[P,I],G=new class extends N{constructor(t,i,s){if(super(t,i,L),this.ne=0,this.Ke=0,this._e=0,this.ce=0,this.Ve=0,this.ae=0,this.le=0,s)for(let h=0;h<i;h++)for(let i=0;i<t;i++)this.$s[h][i].Nh=this.$s[h][i].Rh=s(i,h)}ue(t,i,s){t>=0&&t<this.width&&i>=0&&i<this.height&&(this.$s[i][t].Nh=s)}Ae(t,i,s){t>=0&&t<this.width&&i>=0&&i<this.height&&(this.$s[i][t].Rh=s)}fe(t,i){return!(t<this._e||t>this.ce||i<this.Ve||i>this.ae)&&this.$s[i][t].visible}Ee(t,i){const s=[],h=[];let e,r,o,n,K,_,c,V,a,l,u=1,A=0,f=0,E=0;for(r=this.Ke+i;r>=this.Ve&&r<=this.ae;r+=i,f=A,++u)for(o=.5/u,l=-1,n=Math.floor(E*u+.5),e=this.ne+n*t;n<=u&&e>=this._e&&e<=this.ce;e+=t,++n,l=a){if(K=!0,_=!1,c=n/u,V=l,a=c+o,f>0)if(this.$s[r-i][e].visible&&!this.$s[r-i][e].Rh||this.$s[r-i][e-t].visible&&!this.$s[r-i][e-t].Rh){for(let t=0;t<f&&K;++t)if(V<=h[t]&&a>=s[t])if(this.$s[r][e].Rh){if(V>=s[t]&&a<=h[t]){K=!1;break}s[t]=Math.min(s[t],V),h[t]=Math.max(h[t],a),_=!0}else if(c>s[t]&&c<h[t]){K=!1;break}}else K=!1;K&&(this.$s[r][e].visible=!0,this.$s[r][e].Rh&&(E>=V?E=a:_||(s[A]=V,h[A++]=a)))}}de(t,i){const s=[],h=[];let e,r,o,n,K,_,c,V,a,l,u=1,A=0,f=0,E=0;for(e=this.ne+t;e>=this._e&&e<=this.ce;e+=t,f=A,++u)for(o=.5/u,l=-1,n=Math.floor(E*u+.5),r=this.Ke+n*i;n<=u&&r>=this.Ve&&r<=this.ae;r+=i,++n,l=a){if(K=!0,_=!1,c=n/u,V=l,a=c+o,f>0)if(this.$s[r][e-t].visible&&!this.$s[r][e-t].Rh||this.$s[r-i][e-t].visible&&!this.$s[r-i][e-t].Rh){for(let t=0;t<f&&K;++t)if(V<=h[t]&&a>=s[t])if(this.$s[r][e].Rh){if(V>=s[t]&&a<=h[t]){K=!1;break}s[t]=Math.min(s[t],V),h[t]=Math.max(h[t],a),_=!0}else if(c>s[t]&&c<h[t]){K=!1;break}}else K=!1;K&&(this.$s[r][e].visible=!0,this.$s[r][e].Rh&&(E>=V?E=a:_||(s[A]=V,h[A++]=a)))}}Ce(t,i,s,h,e){if(this.ne=t,this.Ke=i,this.le=s,h)this._e=Math.min(this._e,Math.max(0,t-s)),this.Ve=Math.min(this.Ve,Math.max(0,i-s)),this.ce=Math.max(this.ce,Math.min(this.width-1,t+s)),this.ae=Math.max(this.ae,Math.min(this.height-1,i+s));else{this._e=Math.max(0,t-s),this.Ve=Math.max(0,i-s),this.ce=Math.min(this.width-1,t+s),this.ae=Math.min(this.height-1,i+s);for(let t=this.Ve;t<=this.ae;t++)for(let i=this._e;i<=this.ce;i++)this.$s[t][i].visible=!1}this.$s[i][t].visible=!0,void 0===e?(this.Ee(1,1),this.de(1,1),this.de(1,-1),this.Ee(1,-1),this.Ee(-1,-1),this.de(-1,-1),this.de(-1,1),this.Ee(-1,1)):(1&e&&this.Ee(1,1),2&e&&this.de(1,1),4&e&&this.de(1,-1),8&e&&this.Ee(1,-1),16&e&&this.Ee(-1,-1),32&e&&this.de(-1,-1),64&e&&this.de(-1,1),128&e&&this.Ee(-1,1))}we(){for(let t=this.Ve;t<=this.ae;t++)for(let i=this._e;i<=this.ce;i++){const s=this.$s[t][i];s.Th|=s.visible}}}(80,45);G.$s[22][30].Nh=!0,G.$s[22][30].Rh=!0,G.$s[22][50].Nh=!0,G.$s[22][50].Rh=!0,y.update=function(){y.ee(n.lt)&&P.move(0,-1),y.ee(n.at)&&P.move(-1,0),y.ee(n.ut)&&P.move(1,0),y.ee(n.At)&&P.move(0,1),function(){for(let t=0;t<45;t++)for(let i=0;i<80;i++){G.$s[t][i].Rh?y.th(i,t,0,0,S):y.th(i,t,0,0,F)}for(let t=0;t<B.length;t++)B[t].Lh()}()}}])}));