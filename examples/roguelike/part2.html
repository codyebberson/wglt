<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>WGLT - Roguelike Tutorial - Part 2</title>
    <link href="../../styles.css" rel="stylesheet">
</head>

<body>
    <canvas></canvas>
    <p><a href="http://www.roguebasin.com/index.php?title=Complete_Roguelike_Tutorial,_using_python%2Blibtcod,_part_2">Part 2: The object and the map</a></p>
    <p>This introduces two new concepts: the generic object system that will be the basis for the whole game, and a general map object that you'll use to hold your dungeon.</p>
    <div class="diff">
        <!--STARTDIFF--><div class="c3">--- part1.js	2019-02-16 11:50:18.000000000 -0800</div>
<div class="c2">+++ part2.js	2019-02-16 11:54:55.000000000 -0800</div>
<div class="c1">@@ -1,4 +1,25 @@</div>
<div class="c0"> </div>
<div class="c2">+// Size of the map</div>
<div class="c2">+const MAP_WIDTH = 60;</div>
<div class="c2">+const MAP_HEIGHT = 40;</div>
<div class="c2">+</div>
<div class="c2">+const TILE_SIZE = 16;</div>
<div class="c2">+const TILE_WALL = 1 + 2 * 64 + 0;</div>
<div class="c2">+const TILE_FLOOR = 1 + 2 * 64 + 1;</div>
<div class="c2">+</div>
<div class="c2">+function createMap() {</div>
<div class="c2">+    // Clear the map to all floor</div>
<div class="c2">+    for (let y = 0; y &lt; MAP_HEIGHT; y++) {</div>
<div class="c2">+        for (let x = 0; x &lt; MAP_WIDTH; x++) {</div>
<div class="c2">+            map.setTile(0, x, y, TILE_FLOOR, false);</div>
<div class="c2">+        }</div>
<div class="c2">+    }</div>
<div class="c2">+</div>
<div class="c2">+    // Add a couple walls</div>
<div class="c2">+    map.setTile(0, 25, 22, TILE_WALL, true);</div>
<div class="c2">+    map.setTile(0, 35, 22, TILE_WALL, true);</div>
<div class="c2">+}</div>
<div class="c2">+</div>
<div class="c0"> const app = new wglt.App({</div>
<div class="c0">     canvas: document.querySelector(&#x27;canvas&#x27;),</div>
<div class="c0">     imageUrl: &#x27;../graphics.png&#x27;,</div>
<div class="c1">@@ -13,6 +34,8 @@</div>
<div class="c0"> </div>
<div class="c0"> const sprite = new wglt.Sprite(0, 16, 16, 16, 2, true);</div>
<div class="c0"> const player = new wglt.Entity(game, 30, 20, &#x27;Player&#x27;, sprite, true);</div>
<div class="c2">+const map = new wglt.TileMap(app.gl, MAP_WIDTH, MAP_HEIGHT, 1);</div>
<div class="c2">+game.tileMap = map;</div>
<div class="c0"> game.player = player;</div>
<div class="c0"> game.entities.push(player);</div>
<div class="c0"> </div>
<div class="c1">@@ -21,4 +44,10 @@</div>
<div class="c0"> messageLog.add(&#x27;Use arrow keys to move&#x27;);</div>
<div class="c0"> game.gui.add(messageLog);</div>
<div class="c0"> </div>
<div class="c2">+// Generate the map</div>
<div class="c2">+createMap();</div>
<div class="c2">+</div>
<div class="c2">+// Initial FOV</div>
<div class="c2">+game.tileMap.computeFov(player.x, player.y, 12);</div>
<div class="c2">+</div>
<div class="c0"> app.state = game;</div>
<!--ENDDIFF-->
    </div>
    <script src="../../dist/index.js"></script>
    <script src="part2.js"></script>
</body>

</html>
